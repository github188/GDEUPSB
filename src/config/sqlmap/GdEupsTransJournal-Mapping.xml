<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.bocom.bbip.gdeupsb.entity.GdEupsTransJournal">
	<resultMap id="basicResultMap"
		type="com.bocom.bbip.gdeupsb.entity.GdEupsTransJournal">
		<id column="SQN" property="sqn" jdbcType="CHAR" />
		<result column="BK" property="bk" jdbcType="CHAR" />
		<result column="PFE_TYP" property="pfeTyp" jdbcType="CHAR" />
		<result column="ITG_TYP" property="itgTyp" jdbcType="CHAR" />
		<result column="QRY_SQN" property="qrySqn" jdbcType="CHAR" />
		<result column="TRACE_NO" property="traceNo" jdbcType="CHAR" />
		<result column="REQ_SYS_CDE" property="reqSysCde" jdbcType="CHAR" />
		<result column="REQ_JRN_NO" property="reqJrnNo" jdbcType="CHAR" />
		<result column="REQ_TME" property="reqTme" jdbcType="TIMESTAMP" />
		<result column="BR" property="br" jdbcType="CHAR" />
		<result column="ORG_CDE" property="orgCde" jdbcType="CHAR" />
		<result column="TML_NO" property="tmlNo" jdbcType="CHAR" />
		<result column="TXN_TLR" property="txnTlr" jdbcType="CHAR" />
		<result column="SVR_NME" property="svrNme" jdbcType="CHAR" />
		<result column="COM_NO" property="comNo" jdbcType="CHAR" />
		<result column="EUPS_BUS_TYP" property="eupsBusTyp" jdbcType="CHAR" />
		<result column="RAP_TYP" property="rapTyp" jdbcType="CHAR" />
		<result column="TXN_DTE" property="txnDte" jdbcType="DATE" />
		<result column="TXN_TME" property="txnTme" jdbcType="TIMESTAMP" />
		<result column="TXN_CDE" property="txnCde" jdbcType="CHAR" />
		<result column="TXN_STS" property="txnSts" jdbcType="CHAR" />
		<result column="RSP_MSG" property="rspMsg" jdbcType="VARCHAR" />
		<result column="OLD_TXN_SQN" property="oldTxnSqn" jdbcType="CHAR" />
		<result column="THD_OBK_CDE" property="thdObkCde" jdbcType="CHAR" />
		<result column="RVS_TRACE_NO" property="rvsTraceNo" jdbcType="CHAR" />
		<result column="THD_SUB_CUS_NO" property="thdSubCusNo"
			jdbcType="CHAR" />
		<result column="THD_FEE_PRD" property="thdFeePrd" jdbcType="CHAR" />
		<result column="BK_CD_TYP" property="bkCdTyp" jdbcType="CHAR" />
		<result column="TXN_AMT" property="txnAmt" jdbcType="DECIMAL" />
		<result column="CCY" property="ccy" jdbcType="CHAR" />
		<result column="CHL_TYP" property="chlTyp" jdbcType="CHAR" />
		<result column="ATH_TLR_NO" property="athTlrNo" jdbcType="CHAR" />
		<result column="CHK_TLR" property="chkTlr" jdbcType="CHAR" />
		<result column="REQ_VCH_NO" property="reqVchNo" jdbcType="CHAR" />
		<result column="BUS_KND" property="busKnd" jdbcType="CHAR" />
		<result column="RSP_CDE" property="rspCde" jdbcType="CHAR" />
		<result column="MFM_TXN_CDE" property="mfmTxnCde" jdbcType="CHAR" />
		<result column="MFM_TXN_SUB_CDE" property="mfmTxnSubCde"
			jdbcType="CHAR" />
		<result column="AC_DTE" property="acDte" jdbcType="DATE" />
		<result column="MFM_VCH_NO" property="mfmVchNo" jdbcType="CHAR" />
		<result column="MFM_JRN_NO" property="mfmJrnNo" jdbcType="CHAR" />
		<result column="MFM_TXN_STS" property="mfmTxnSts" jdbcType="CHAR" />
		<result column="MFM_RSP_CDE" property="mfmRspCde" jdbcType="CHAR" />
		<result column="MFM_RSP_MSG" property="mfmRspMsg" jdbcType="VARCHAR" />
		<result column="THD_TXN_CDE" property="thdTxnCde" jdbcType="CHAR" />
		<result column="THD_TXN_DTE" property="thdTxnDte" jdbcType="DATE" />
		<result column="THD_TXN_TME" property="thdTxnTme" jdbcType="TIMESTAMP" />
		<result column="THD_SQN" property="thdSqn" jdbcType="CHAR" />
		<result column="THD_TXN_STS" property="thdTxnSts" jdbcType="CHAR" />
		<result column="THD_RSP_CDE" property="thdRspCde" jdbcType="CHAR" />
		<result column="THD_RSP_MSG" property="thdRspMsg" jdbcType="CHAR" />
		<result column="RCN_FLG" property="rcnFlg" jdbcType="CHAR" />
		<result column="MFM_DYT_RCN_FLG" property="mfmDytRcnFlg"
			jdbcType="CHAR" />
		<result column="MFM_EOD_RCN_FLG" property="mfmEodRcnFlg"
			jdbcType="CHAR" />
		<result column="MFM_RCN_BAT" property="mfmRcnBat" jdbcType="CHAR" />
		<result column="MFM_RCN_TME" property="mfmRcnTme" jdbcType="TIMESTAMP" />
		<result column="THD_RCN_FLG" property="thdRcnFlg" jdbcType="CHAR" />
		<result column="THD_RCN_TME" property="thdRcnTme" jdbcType="TIMESTAMP" />
		<result column="THD_RCN_BAT" property="thdRcnBat" jdbcType="CHAR" />
		<result column="IS_BAT_FLG" property="isBatFlg" jdbcType="CHAR" />
		<result column="BAT_NO" property="batNo" jdbcType="CHAR" />
		<result column="EXT_RCN_FLG" property="extRcnFlg" jdbcType="CHAR" />
		<result column="OUR_OTH_FLG" property="ourOthFlg" jdbcType="CHAR" />
		<result column="THD_RGN_NO" property="thdRgnNo" jdbcType="CHAR" />
		<result column="THD_CUS_NO" property="thdCusNo" jdbcType="CHAR" />
		<result column="THD_CUS_NME" property="thdCusNme" jdbcType="VARCHAR" />
		<result column="PAY_CHL" property="payChl" jdbcType="CHAR" />
		<result column="SPL_NO" property="splNo" jdbcType="CHAR" />
		<result column="SPL_TER_NO" property="splTerNo" jdbcType="CHAR" />
		<result column="TXN_TYP" property="txnTyp" jdbcType="CHAR" />
		<result column="CUS_AC" property="cusAc" jdbcType="CHAR" />
		<result column="CUS_NME" property="cusNme" jdbcType="VARCHAR" />
		<result column="ID_TYP" property="idTyp" jdbcType="CHAR" />
		<result column="ID_NO" property="idNo" jdbcType="VARCHAR" />
		<result column="CMU_TEL" property="cmuTel" jdbcType="VARCHAR" />
		<result column="ACC_TYP" property="accTyp" jdbcType="CHAR" />
		<result column="ACC_SEQ" property="accSeq" jdbcType="CHAR" />
		<result column="BV_KND" property="bvKnd" jdbcType="CHAR" />
		<result column="BV_NO" property="bvNo" jdbcType="CHAR" />
		<result column="LIS_ACC" property="lisAcc" jdbcType="CHAR" />
		<result column="CHO_NO" property="choNo" jdbcType="CHAR" />
		<result column="RMK_CDE" property="rmkCde" jdbcType="CHAR" />
		<result column="CSH_NO" property="cshNo" jdbcType="CHAR" />
		<result column="DRW_MDE" property="drwMde" jdbcType="CHAR" />
		<result column="REQ_TXN_AMT" property="reqTxnAmt" jdbcType="DECIMAL" />
		<result column="FUL_DED_FLG" property="fulDedFlg" jdbcType="CHAR" />
		<result column="HFE" property="hfe" jdbcType="DECIMAL" />
		<result column="HFE_ITM_SEQ" property="hfeItmSeq" jdbcType="CHAR" />
		<result column="HFE_PST_BR" property="hfePstBr" jdbcType="CHAR" />
		<result column="PRT_FLG" property="prtFlg" jdbcType="CHAR" />
		<result column="PRT_CNT" property="prtCnt" jdbcType="INTEGER" />
		<result column="BAK_FLD1" property="bakFld1" jdbcType="CHAR" />
		<result column="BAK_FLD2" property="bakFld2" jdbcType="CHAR" />
		<result column="BAK_FLD3" property="bakFld3" jdbcType="CHAR" />
		<result column="BAK_FLD4" property="bakFld4" jdbcType="CHAR" />
		<result column="BAK_FLD5" property="bakFld5" jdbcType="CHAR" />
		<result column="BAK_FLD6" property="bakFld6" jdbcType="CHAR" />
		<result column="RSV_FLD1" property="rsvFld1" jdbcType="VARCHAR" />
		<result column="RSV_FLD2" property="rsvFld2" jdbcType="VARCHAR" />
		<result column="RSV_FLD3" property="rsvFld3" jdbcType="VARCHAR" />
		<result column="RSV_FLD4" property="rsvFld4" jdbcType="VARCHAR" />
		<result column="RSV_FLD5" property="rsvFld5" jdbcType="VARCHAR" />
		<result column="RSV_FLD6" property="rsvFld6" jdbcType="VARCHAR" />
		<result column="FIL_FLG" property="filFlg" jdbcType="CHAR" />
		<result column="TOTAL_AMT" property="totalAmt" jdbcType="DECIMAL" />
		<result column="TOTAL_COUNT" property="totalCount" jdbcType="INTEGER" />
		<result column="ALL_SUM_AMT" property="ASumAmt" jdbcType="DECIMAL" />
		<result column="ALL_SUM_CNT" property="ASumCnt" jdbcType="INTEGER" />
		<result column="SUC_SUM_AMT" property="NSumAmt" jdbcType="DECIMAL" />
		<result column="SUC_SUM_CNT" property="NSumCnt" jdbcType="INTEGER" />
		<result column="RVS_SUM_AMT" property="RSumAmt" jdbcType="DECIMAL" />
		<result column="RVS_SUM_CNT" property="RSumCnt" jdbcType="INTEGER" />
		<result column="TRADE_STS" property="tradeSts" jdbcType="CHAR" />
		<result column="FMT_TXN_DTE" property="fmtTxnDte" jdbcType="VARCHAR" />
		<result column="FMT_TXN_TME" property="fmtTxnTme" jdbcType="VARCHAR" />
		<result column="FMT_HTXN_DTE" property="fmtHTxnDte" jdbcType="VARCHAR" />
		<result column="FMT_HTXN_TME" property="fmtHTxnTme" jdbcType="VARCHAR" />
		<result column="FMT_TTXN_DTE" property="fmtTTxnDte" jdbcType="VARCHAR" />
		<result column="FMT_TTXN_TME" property="fmtTTxnTme" jdbcType="VARCHAR" />
		<result column="FMT_AC_DTE" property="fmtAcDte" jdbcType="VARCHAR" />
	</resultMap>
	<sql id="baseColumnList">
		SQN, BK, PFE_TYP, ITG_TYP, QRY_SQN, TRACE_NO, REQ_SYS_CDE,
		REQ_JRN_NO,
		REQ_TME, BR,
		ORG_CDE, TML_NO, TXN_TLR, SVR_NME, COM_NO,
		EUPS_BUS_TYP, RAP_TYP, TXN_DTE,
		TXN_TME,
		TXN_CDE, TXN_STS, RSP_MSG,
		OLD_TXN_SQN, THD_OBK_CDE, RVS_TRACE_NO,
		THD_SUB_CUS_NO,
		THD_FEE_PRD,
		BK_CD_TYP, TXN_AMT, CCY, CHL_TYP, ATH_TLR_NO, CHK_TLR, REQ_VCH_NO,
		BUS_KND,
		RSP_CDE, MFM_TXN_CDE, MFM_TXN_SUB_CDE, AC_DTE, MFM_VCH_NO,
		MFM_JRN_NO,
		MFM_TXN_STS,
		MFM_RSP_CDE, MFM_RSP_MSG, THD_TXN_CDE,
		THD_TXN_DTE, THD_TXN_TME, THD_SQN,
		THD_TXN_STS,
		THD_RSP_CDE,
		THD_RSP_MSG, RCN_FLG, MFM_DYT_RCN_FLG, MFM_EOD_RCN_FLG, MFM_RCN_BAT,
		MFM_RCN_TME, THD_RCN_FLG, THD_RCN_TME, THD_RCN_BAT, IS_BAT_FLG,
		BAT_NO, EXT_RCN_FLG,
		OUR_OTH_FLG, THD_RGN_NO, THD_CUS_NO, THD_CUS_NME,
		PAY_CHL, SPL_NO, SPL_TER_NO,
		TXN_TYP,
		CUS_AC, CUS_NME, ID_TYP, ID_NO,
		CMU_TEL, ACC_TYP, ACC_SEQ, BV_KND, BV_NO,
		LIS_ACC,
		CHO_NO, RMK_CDE,
		CSH_NO, DRW_MDE, REQ_TXN_AMT, FUL_DED_FLG, HFE, HFE_ITM_SEQ,
		HFE_PST_BR,
		PRT_FLG, PRT_CNT, BAK_FLD1, BAK_FLD2, BAK_FLD3, BAK_FLD4,
		BAK_FLD5, BAK_FLD6,
		RSV_FLD1,
		RSV_FLD2, RSV_FLD3, RSV_FLD4, RSV_FLD5,
		RSV_FLD6, FIL_FLG
	</sql>
	<!--广东烟草清算信息查询 -->
	<select id="qryClearAccount" resultType="java.util.Map"
		parameterType="com.bocom.bbip.gdeupsb.entity.GdEupsTransJournal">
		SELECT sum(cast(TXN_AMT as bigint)) as
		sumAmt,coalesce(COUNT(*),0) totCnt
		FROM eups.EUPS_TRANS_JOURNAL
		WHERE
		COM_NO = #{comNo,jdbcType=CHAR}
		AND TXN_DTE=#{txnDte,jdbcType=DATE} AND
		MFM_TXN_STS='S'
		AND MFM_RSP_CDE='SC0000' and RCN_FLG='0'
	</select>

	<!--广东烟草信息统计查询 -->
	<select id="findTbcTransJournal" resultType="java.util.Map"
		parameterType="com.bocom.bbip.gdeupsb.entity.GdEupsTransJournal">
		SELECT Count(*) totSum, COALESCE(sum(CAST(TXN_AMT * 100
		AS BIGINT)),0)
		totAmt
		FROM eups.EUPS_TRANS_JOURNAL
		WHERE COM_NO =
		#{comNo,jdbcType=CHAR}
		AND TXN_DTE=#{txnDte,jdbcType=DATE} AND
		MFM_TXN_STS='S'
		AND MFM_RSP_CDE='SC0000' AND TXN_CDE='gdeupsb.tb' and
		SQN
		&gt;=#{sqn,jdbcType=CHAR}
	</select>
	<!--广东烟草流水详细信息查询 -->
	<select id="findTbcTransJournalDetails" resultMap="basicResultMap"
		parameterType="com.bocom.bbip.gdeupsb.entity.GdEupsTransJournal">
		SELECT *
		FROM eups.EUPS_TRANS_JOURNAL
		WHERE COM_NO =
		#{comNo,jdbcType=CHAR}
		AND TXN_DTE=#{txnDte,jdbcType=DATE} AND
		MFM_TXN_STS='S'
		AND MFM_RSP_CDE='SC0000' AND TXN_CDE='gdeupsb.tb' and
		SQN
		&gt;=#{sqn,jdbcType=CHAR}
	</select>


	<!--广州电力划扣对账统计信息查询 -->
	<select id="findGzEleChkHKInfo" resultType="java.util.Map"
		parameterType="com.bocom.bbip.gdeupsb.entity.GdEupsTransJournal">
		select count(*) totalDeal, sum(TXN_AMT) totalFee from
		eups.EUPS_TRANS_JOURNAL where EUPS_BUS_TYP='ELEC01' and
		MFM_TXN_STS='S' and TXN_STS='S' and TXN_TYP='N'
		and
		BAK_FLD1=#{bakFld1,jdbcType=CHAR}
		and THD_TXN_CDE='HK'
	</select>

	<!--广州电力划扣对账明细信息查询 -->
	<select id="findGzEleChkHKDetail" resultType="java.util.Map"
		parameterType="com.bocom.bbip.gdeupsb.entity.GdEupsTransJournal">
		select THD_SQN tLogNo,THD_CUS_NO thdCusNo,THD_TXN_DTE
		tActDt,BAK_FLD1 actDat, TXN_TME BkTim, RSV_FLD2 bkLog,
		CUS_AC actNo,
		'0200' txnKnd,TXN_AMT txnAmt,' ' oTlogNo,THD_TXN_DTE dLDat,THD_TXN_TME
		dLTim,RSV_FLD1 rmkTmp,BAK_FLD2 lChkTm
		from
		eups.EUPS_TRANS_JOURNAL where
		EUPS_BUS_TYP='ELEC01' and
		MFM_TXN_STS='S' and TXN_STS='S' and
		TXN_TYP='N'
		and
		BAK_FLD1=#{bakFld1,jdbcType=CHAR}
		and THD_TXN_CDE='HK'
	</select>

	<!--广州电力缴费对账统计信息查询 -->
	<select id="findGzEleChkJFInfo" resultType="java.util.Map"
		parameterType="com.bocom.bbip.gdeupsb.entity.GdEupsTransJournal">
		select count(*) totalDeal, sum(TXN_AMT) totalFee from
		eups.EUPS_TRANS_JOURNAL where
		EUPS_BUS_TYP='ELEC01' and
		MFM_TXN_STS='S' and TXN_STS='S' and
		TXN_TYP='N' and THD_TXN_STS='S'
		and BAK_FLD1=#{bakFld1,jdbcType=CHAR}
		and THD_TXN_CDE='JF'
	</select>

	<!--广州电力缴费对账明细信息查询 -->
	<select id="findGzEleChkJFDetail" resultType="java.util.Map"
		parameterType="com.bocom.bbip.gdeupsb.entity.GdEupsTransJournal">
		select THD_SQN tLogNo,THD_CUS_NO thdCusNo,THD_TXN_DTE
		tActDt,BAK_FLD1 actDat, TXN_TME BkTim, RSV_FLD2 bkLog,RSV_FLD3 ZPFLG,
		CUS_AC actNo,
		'0200' txnKnd,TXN_AMT txnAmt,' ' oTlogNo,THD_TXN_DTE
		dLDat,THD_TXN_TME
		dLTim,RSV_FLD1 rmkTmp, BAK_FLD3 bakFld3, BV_NO bvNo,
		BAK_FLD2 lChkTm
		from
		eups.EUPS_TRANS_JOURNAL where
		EUPS_BUS_TYP='ELEC01'
		and
		MFM_TXN_STS='S' and TXN_STS='S' and
		TXN_TYP='N' and THD_TXN_STS='S'
		and BAK_FLD1=#{bakFld1,jdbcType=CHAR}
		and THD_TXN_CDE='JF'
	</select>


	<select id="getCheckInfoCount" resultType="java.lang.Integer">
		select count(*) from ${EUPS_SCHEMA}.EUPS_TRANS_JOURNAL

		<trim prefix="WHERE" prefixOverrides="AND">
			<if test="startDate!=null">
				AND TXN_DTE &gt;= #{startDate,jdbcType=VARCHAR}
			</if>
			<if test="endDate!=null">
				AND TXN_DTE &lt;= #{endDate,jdbcType=DATE}
			</if>
			<if test="EupsBusType!=null">
				AND EUPS_BUS_TYP = #{EupsBusType,jdbcType=DATE}
			</if>
			<if test="EupsBusType!=null">
				and RCN_FLG='1'
			</if>
		</trim>
	</select>

	<select id="getCheckInfo" resultMap="basicResultMap">
		select
		<include refid="baseColumnList" />
		from ${EUPS_SCHEMA}.EUPS_TRANS_JOURNAL
		<trim prefix="WHERE" prefixOverrides="AND">
			<if test="startDate!=null">
				AND TXN_DTE &gt;= #{startDate,jdbcType=VARCHAR}
			</if>
			<if test="endDate!=null">
				AND TXN_DTE &lt;= #{endDate,jdbcType=VARCHAR}
			</if>
			<if test="EupsBusType!=null">
				AND EUPS_BUS_TYP = #{EupsBusType,jdbcType=VARCHAR}
			</if>
			<if test="EupsBusType!=null">
				and RCN_FLG='1'
			</if>
		</trim>
	</select>



	<select id="findComPayInfo" resultType="java.util.Map"
		parameterType="java.util.Map">
		select
		THD_CUS_NO,CUS_AC,TXN_AMT,CUS_NME,CCY,AC_DTE,TXN_TLR,MFM_VCH_NO
		from
		${EUPS_SCHEMA}.EUPS_TRANS_JOURNAL where COM_NO in
		(#{cAgtNoDl},#{cAgtNoYh},#{cAgtNoPl}) and
		AC_DTE &gt;= #{bgnDte}
		and
		AC_DTE &lt;= #{endDte} and MFM_TXN_STS='S' and
		BAK_FLD6='DG' and
		MFM_VCH_NO like '%${tckNo}%'
		and CUS_AC like
		'%${cusAc}%' order by
		CUS_AC,AC_DTE fetch first 1 rows only
	</select>

	<!-- 惠州燃气代扣流水信息查询 -->
	<select id="findGasJnlInfo" resultMap="basicResultMap">
		SELECT
		THD_CUS_NO,RSV_FLD6,CUS_AC,CUS_NME,TXN_AMT,TXN_TME,MFM_VCH_NO,SQN,THD_SQN
		FROM EUPS.EUPS_TRANS_JOURNAL WHERE MFM_TXN_STS='S' AND
		MFM_RSP_CDE='SC0000' AND BAK_FLD1='0' AND BAK_FLD2='B0'
		<trim>
			<if test="thdCusNo!=null">
				AND THD_CUS_NO=#{thdCusNo,jdbcType=CHAR}
			</if>
			<if test="cusAc!=null">
				AND CUS_AC=#{cusAc,jdbcType=CHAR}
			</if>
			<if test="cusNme!=null">
				AND CUS_NME=#{cusNme,jdbcType=VARCHAR}
			</if>
			<if test="beginDate!=null">
				AND TXN_DTE &gt;=#{beginDate,jdbcType=DATE}
			</if>
			<if test="endDate!=null">
				AND TXN_DTE &lt;=#{endDate,jdbcType=DATE}
			</if>
		</trim>
	</select>

	<select id="findCheck" resultMap="basicResultMap"
		parameterType="com.bocom.bbip.gdeupsb.entity.GdEupsTransJournal">
		select
		<include refid="baseColumnList" />
		from EUPS.EUPS_TRANS_JOURNAL
		<trim prefix="WHERE" prefixOverrides="AND">
			<if test="sqn!=null">
				AND SQN=#{sqn,jdbcType=CHAR}
			</if>
			<if test="bk!=null">
				AND BK=#{bk,jdbcType=CHAR}
			</if>
			<if test="pfeTyp!=null">
				AND PFE_TYP=#{pfeTyp,jdbcType=CHAR}
			</if>
			<if test="itgTyp!=null">
				AND ITG_TYP=#{itgTyp,jdbcType=CHAR}
			</if>
			<if test="qrySqn!=null">
				AND QRY_SQN=#{qrySqn,jdbcType=CHAR}
			</if>
			<if test="traceNo!=null">
				AND TRACE_NO=#{traceNo,jdbcType=CHAR}
			</if>
			<if test="reqSysCde!=null">
				AND REQ_SYS_CDE=#{reqSysCde,jdbcType=CHAR}
			</if>
			<if test="reqJrnNo!=null">
				AND REQ_JRN_NO=#{reqJrnNo,jdbcType=CHAR}
			</if>
			<if test="reqTme!=null">
				AND REQ_TME=#{reqTme,jdbcType=TIMESTAMP}
			</if>
			<if test="br!=null">
				AND BR=#{br,jdbcType=CHAR}
			</if>
			<if test="orgCde!=null">
				AND ORG_CDE=#{orgCde,jdbcType=CHAR}
			</if>
			<if test="tmlNo!=null">
				AND TML_NO=#{tmlNo,jdbcType=CHAR}
			</if>
			<if test="txnTlr!=null">
				AND TXN_TLR=#{txnTlr,jdbcType=CHAR}
			</if>
			<if test="svrNme!=null">
				AND SVR_NME=#{svrNme,jdbcType=CHAR}
			</if>
			<if test="comNo!=null">
				AND COM_NO=#{comNo,jdbcType=CHAR}
			</if>
			<if test="eupsBusTyp!=null">
				AND EUPS_BUS_TYP=#{eupsBusTyp,jdbcType=CHAR}
			</if>
			<if test="rapTyp!=null">
				AND RAP_TYP=#{rapTyp,jdbcType=CHAR}
			</if>
			<if test="txnDte!=null">
				AND TXN_DTE=#{txnDte,jdbcType=DATE}
			</if>
			<if test="txnTme!=null">
				AND TXN_TME=#{txnTme,jdbcType=TIMESTAMP}
			</if>
			<if test="txnCde!=null">
				AND TXN_CDE=#{txnCde,jdbcType=CHAR}
			</if>
			<if test="txnSts!=null">
				AND TXN_STS=#{txnSts,jdbcType=CHAR}
			</if>
			<if test="rspMsg!=null">
				AND RSP_MSG=#{rspMsg,jdbcType=VARCHAR}
			</if>
			<if test="oldTxnSqn!=null">
				AND OLD_TXN_SQN=#{oldTxnSqn,jdbcType=CHAR}
			</if>
			<if test="thdObkCde!=null">
				AND THD_OBK_CDE=#{thdObkCde,jdbcType=CHAR}
			</if>
			<if test="rvsTraceNo!=null">
				AND RVS_TRACE_NO=#{rvsTraceNo,jdbcType=CHAR}
			</if>
			<if test="thdSubCusNo!=null">
				AND THD_SUB_CUS_NO=#{thdSubCusNo,jdbcType=CHAR}
			</if>
			<if test="thdFeePrd!=null">
				AND THD_FEE_PRD=#{thdFeePrd,jdbcType=CHAR}
			</if>
			<if test="bkCdTyp!=null">
				AND BK_CD_TYP=#{bkCdTyp,jdbcType=CHAR}
			</if>
			<if test="txnAmt!=null">
				AND TXN_AMT=#{txnAmt,jdbcType=DECIMAL}
			</if>
			<if test="ccy!=null">
				AND CCY=#{ccy,jdbcType=CHAR}
			</if>
			<if test="chlTyp!=null">
				AND CHL_TYP=#{chlTyp,jdbcType=CHAR}
			</if>
			<if test="athTlrNo!=null">
				AND ATH_TLR_NO=#{athTlrNo,jdbcType=CHAR}
			</if>
			<if test="chkTlr!=null">
				AND CHK_TLR=#{chkTlr,jdbcType=CHAR}
			</if>
			<if test="reqVchNo!=null">
				AND REQ_VCH_NO=#{reqVchNo,jdbcType=CHAR}
			</if>
			<if test="busKnd!=null">
				AND BUS_KND=#{busKnd,jdbcType=CHAR}
			</if>
			<if test="rspCde!=null">
				AND RSP_CDE=#{rspCde,jdbcType=CHAR}
			</if>
			<if test="mfmTxnCde!=null">
				AND MFM_TXN_CDE=#{mfmTxnCde,jdbcType=CHAR}
			</if>
			<if test="mfmTxnSubCde!=null">
				AND MFM_TXN_SUB_CDE=#{mfmTxnSubCde,jdbcType=CHAR}
			</if>
			<if test="acDte!=null">
				AND AC_DTE=#{acDte,jdbcType=DATE}
			</if>
			<if test="mfmVchNo!=null">
				AND MFM_VCH_NO=#{mfmVchNo,jdbcType=CHAR}
			</if>
			<if test="mfmJrnNo!=null">
				AND MFM_JRN_NO=#{mfmJrnNo,jdbcType=CHAR}
			</if>
			<if test="mfmTxnSts!=null">
				AND MFM_TXN_STS=#{mfmTxnSts,jdbcType=CHAR}
			</if>
			<if test="mfmRspCde!=null">
				AND MFM_RSP_CDE=#{mfmRspCde,jdbcType=CHAR}
			</if>
			<if test="mfmRspMsg!=null">
				AND MFM_RSP_MSG=#{mfmRspMsg,jdbcType=VARCHAR}
			</if>
			<if test="thdTxnCde!=null">
				AND THD_TXN_CDE=#{thdTxnCde,jdbcType=CHAR}
			</if>
			<if test="thdTxnDte!=null">
				AND THD_TXN_DTE=#{thdTxnDte,jdbcType=DATE}
			</if>
			<if test="thdTxnTme!=null">
				AND THD_TXN_TME=#{thdTxnTme,jdbcType=TIMESTAMP}
			</if>
			<if test="thdSqn!=null">
				AND THD_SQN=#{thdSqn,jdbcType=CHAR}
			</if>
			<if test="thdTxnSts!=null">
				AND THD_TXN_STS=#{thdTxnSts,jdbcType=CHAR}
			</if>
			<if test="thdRspCde!=null">
				AND THD_RSP_CDE=#{thdRspCde,jdbcType=CHAR}
			</if>
			<if test="thdRspMsg!=null">
				AND THD_RSP_MSG=#{thdRspMsg,jdbcType=CHAR}
			</if>
			<if test="rcnFlg!=null">
				AND RCN_FLG=#{rcnFlg,jdbcType=CHAR}
			</if>
			<if test="mfmDytRcnFlg!=null">
				AND MFM_DYT_RCN_FLG=#{mfmDytRcnFlg,jdbcType=CHAR}
			</if>
			<if test="mfmEodRcnFlg!=null">
				AND MFM_EOD_RCN_FLG=#{mfmEodRcnFlg,jdbcType=CHAR}
			</if>
			<if test="mfmRcnBat!=null">
				AND MFM_RCN_BAT=#{mfmRcnBat,jdbcType=CHAR}
			</if>
			<if test="mfmRcnTme!=null">
				AND MFM_RCN_TME=#{mfmRcnTme,jdbcType=TIMESTAMP}
			</if>
			<if test="thdRcnFlg!=null">
				AND THD_RCN_FLG=#{thdRcnFlg,jdbcType=CHAR}
			</if>
			<if test="thdRcnTme!=null">
				AND THD_RCN_TME=#{thdRcnTme,jdbcType=TIMESTAMP}
			</if>
			<if test="thdRcnBat!=null">
				AND THD_RCN_BAT=#{thdRcnBat,jdbcType=CHAR}
			</if>
			<if test="isBatFlg!=null">
				AND IS_BAT_FLG=#{isBatFlg,jdbcType=CHAR}
			</if>
			<if test="batNo!=null">
				AND BAT_NO=#{batNo,jdbcType=CHAR}
			</if>
			<if test="extRcnFlg!=null">
				AND EXT_RCN_FLG=#{extRcnFlg,jdbcType=CHAR}
			</if>
			<if test="ourOthFlg!=null">
				AND OUR_OTH_FLG=#{ourOthFlg,jdbcType=CHAR}
			</if>
			<if test="thdRgnNo!=null">
				AND THD_RGN_NO=#{thdRgnNo,jdbcType=CHAR}
			</if>
			<if test="thdCusNo!=null">
				AND THD_CUS_NO=#{thdCusNo,jdbcType=CHAR}
			</if>
			<if test="thdCusNme!=null">
				AND THD_CUS_NME=#{thdCusNme,jdbcType=VARCHAR}
			</if>
			<if test="payChl!=null">
				AND PAY_CHL=#{payChl,jdbcType=CHAR}
			</if>
			<if test="splNo!=null">
				AND SPL_NO=#{splNo,jdbcType=CHAR}
			</if>
			<if test="splTerNo!=null">
				AND SPL_TER_NO=#{splTerNo,jdbcType=CHAR}
			</if>
			<if test="txnTyp!=null">
				AND TXN_TYP=#{txnTyp,jdbcType=CHAR}
			</if>
			<if test="cusAc!=null">
				AND CUS_AC=#{cusAc,jdbcType=CHAR}
			</if>
			<if test="cusNme!=null">
				AND CUS_NME=#{cusNme,jdbcType=VARCHAR}
			</if>
			<if test="idTyp!=null">
				AND ID_TYP=#{idTyp,jdbcType=CHAR}
			</if>
			<if test="idNo!=null">
				AND ID_NO=#{idNo,jdbcType=VARCHAR}
			</if>
			<if test="cmuTel!=null">
				AND CMU_TEL=#{cmuTel,jdbcType=VARCHAR}
			</if>
			<if test="accTyp!=null">
				AND ACC_TYP=#{accTyp,jdbcType=CHAR}
			</if>
			<if test="accSeq!=null">
				AND ACC_SEQ=#{accSeq,jdbcType=CHAR}
			</if>
			<if test="bvKnd!=null">
				AND BV_KND=#{bvKnd,jdbcType=CHAR}
			</if>
			<if test="bvNo!=null">
				AND BV_NO=#{bvNo,jdbcType=CHAR}
			</if>
			<if test="lisAcc!=null">
				AND LIS_ACC=#{lisAcc,jdbcType=CHAR}
			</if>
			<if test="choNo!=null">
				AND CHO_NO=#{choNo,jdbcType=CHAR}
			</if>
			<if test="rmkCde!=null">
				AND RMK_CDE=#{rmkCde,jdbcType=CHAR}
			</if>
			<if test="cshNo!=null">
				AND CSH_NO=#{cshNo,jdbcType=CHAR}
			</if>
			<if test="drwMde!=null">
				AND DRW_MDE=#{drwMde,jdbcType=CHAR}
			</if>
			<if test="reqTxnAmt!=null">
				AND REQ_TXN_AMT=#{reqTxnAmt,jdbcType=DECIMAL}
			</if>
			<if test="fulDedFlg!=null">
				AND FUL_DED_FLG=#{fulDedFlg,jdbcType=CHAR}
			</if>
			<if test="hfe!=null">
				AND HFE=#{hfe,jdbcType=DECIMAL}
			</if>
			<if test="hfeItmSeq!=null">
				AND HFE_ITM_SEQ=#{hfeItmSeq,jdbcType=CHAR}
			</if>
			<if test="hfePstBr!=null">
				AND HFE_PST_BR=#{hfePstBr,jdbcType=CHAR}
			</if>
			<if test="prtFlg!=null">
				AND PRT_FLG=#{prtFlg,jdbcType=CHAR}
			</if>
			<if test="prtCnt!=null">
				AND PRT_CNT=#{prtCnt,jdbcType=INTEGER}
			</if>
			<if test="bakFld1!=null">
				AND BAK_FLD1=#{bakFld1,jdbcType=CHAR}
			</if>
			<if test="bakFld2!=null">
				AND BAK_FLD2=#{bakFld2,jdbcType=CHAR}
			</if>
			<if test="bakFld3!=null">
				AND BAK_FLD3=#{bakFld3,jdbcType=CHAR}
			</if>
			<if test="bakFld4!=null">
				AND BAK_FLD4=#{bakFld4,jdbcType=CHAR}
			</if>
			<if test="bakFld5!=null">
				AND BAK_FLD5=#{bakFld5,jdbcType=CHAR}
			</if>
			<if test="bakFld6!=null">
				AND BAK_FLD6=#{bakFld6,jdbcType=CHAR}
			</if>
			<if test="rsvFld1!=null">
				AND RSV_FLD1=#{rsvFld1,jdbcType=VARCHAR}
			</if>
			<if test="rsvFld2!=null">
				AND RSV_FLD2=#{rsvFld2,jdbcType=VARCHAR}
			</if>
			<if test="rsvFld3!=null">
				AND RSV_FLD3=#{rsvFld3,jdbcType=VARCHAR}
			</if>
			<if test="rsvFld4!=null">
				AND RSV_FLD4=#{rsvFld4,jdbcType=VARCHAR}
			</if>
			<if test="rsvFld5!=null">
				AND RSV_FLD5=#{rsvFld5,jdbcType=VARCHAR}
			</if>
			<if test="rsvFld6!=null">
				AND RSV_FLD6=#{rsvFld6,jdbcType=VARCHAR}
			</if>
			<if test="filFlg!=null">
				AND FIL_FLG=#{filFlg,jdbcType=CHAR}
			</if>
		</trim>
		order by MFM_VCH_NO
	</select>

	<select id="findSumTxnAmt" resultType="java.util.Map"
		parameterType="com.bocom.bbip.gdeupsb.entity.GdEupsTransJournal">
		select count(TXN_AMT) as totNum ,sum(TXN_AMT) as totAmt from
		EUPS.EUPS_TRANS_JOURNAL
		<trim prefix="WHERE" prefixOverrides="AND">
			<if test="sqn!=null">
				AND SQN=#{sqn,jdbcType=CHAR}
			</if>
			<if test="bk!=null">
				AND BK=#{bk,jdbcType=CHAR}
			</if>
			<if test="pfeTyp!=null">
				AND PFE_TYP=#{pfeTyp,jdbcType=CHAR}
			</if>
			<if test="itgTyp!=null">
				AND ITG_TYP=#{itgTyp,jdbcType=CHAR}
			</if>
			<if test="qrySqn!=null">
				AND QRY_SQN=#{qrySqn,jdbcType=CHAR}
			</if>
			<if test="traceNo!=null">
				AND TRACE_NO=#{traceNo,jdbcType=CHAR}
			</if>
			<if test="reqSysCde!=null">
				AND REQ_SYS_CDE=#{reqSysCde,jdbcType=CHAR}
			</if>
			<if test="reqJrnNo!=null">
				AND REQ_JRN_NO=#{reqJrnNo,jdbcType=CHAR}
			</if>
			<if test="reqTme!=null">
				AND REQ_TME=#{reqTme,jdbcType=TIMESTAMP}
			</if>
			<if test="br!=null">
				AND BR=#{br,jdbcType=CHAR}
			</if>
			<if test="orgCde!=null">
				AND ORG_CDE=#{orgCde,jdbcType=CHAR}
			</if>
			<if test="tmlNo!=null">
				AND TML_NO=#{tmlNo,jdbcType=CHAR}
			</if>
			<if test="txnTlr!=null">
				AND TXN_TLR=#{txnTlr,jdbcType=CHAR}
			</if>
			<if test="svrNme!=null">
				AND SVR_NME=#{svrNme,jdbcType=CHAR}
			</if>
			<if test="comNo!=null">
				AND COM_NO=#{comNo,jdbcType=CHAR}
			</if>
			<if test="eupsBusTyp!=null">
				AND EUPS_BUS_TYP=#{eupsBusTyp,jdbcType=CHAR}
			</if>
			<if test="rapTyp!=null">
				AND RAP_TYP=#{rapTyp,jdbcType=CHAR}
			</if>
			<if test="txnDte!=null">
				AND TXN_DTE=#{txnDte,jdbcType=DATE}
			</if>
			<if test="txnTme!=null">
				AND TXN_TME=#{txnTme,jdbcType=TIMESTAMP}
			</if>
			<if test="txnCde!=null">
				AND TXN_CDE=#{txnCde,jdbcType=CHAR}
			</if>
			<if test="txnSts!=null">
				AND TXN_STS=#{txnSts,jdbcType=CHAR}
			</if>
			<if test="rspMsg!=null">
				AND RSP_MSG=#{rspMsg,jdbcType=VARCHAR}
			</if>
			<if test="oldTxnSqn!=null">
				AND OLD_TXN_SQN=#{oldTxnSqn,jdbcType=CHAR}
			</if>
			<if test="thdObkCde!=null">
				AND THD_OBK_CDE=#{thdObkCde,jdbcType=CHAR}
			</if>
			<if test="rvsTraceNo!=null">
				AND RVS_TRACE_NO=#{rvsTraceNo,jdbcType=CHAR}
			</if>
			<if test="thdSubCusNo!=null">
				AND THD_SUB_CUS_NO=#{thdSubCusNo,jdbcType=CHAR}
			</if>
			<if test="thdFeePrd!=null">
				AND THD_FEE_PRD=#{thdFeePrd,jdbcType=CHAR}
			</if>
			<if test="bkCdTyp!=null">
				AND BK_CD_TYP=#{bkCdTyp,jdbcType=CHAR}
			</if>
			<if test="txnAmt!=null">
				AND TXN_AMT=#{txnAmt,jdbcType=DECIMAL}
			</if>
			<if test="ccy!=null">
				AND CCY=#{ccy,jdbcType=CHAR}
			</if>
			<if test="chlTyp!=null">
				AND CHL_TYP=#{chlTyp,jdbcType=CHAR}
			</if>
			<if test="athTlrNo!=null">
				AND ATH_TLR_NO=#{athTlrNo,jdbcType=CHAR}
			</if>
			<if test="chkTlr!=null">
				AND CHK_TLR=#{chkTlr,jdbcType=CHAR}
			</if>
			<if test="reqVchNo!=null">
				AND REQ_VCH_NO=#{reqVchNo,jdbcType=CHAR}
			</if>
			<if test="busKnd!=null">
				AND BUS_KND=#{busKnd,jdbcType=CHAR}
			</if>
			<if test="rspCde!=null">
				AND RSP_CDE=#{rspCde,jdbcType=CHAR}
			</if>
			<if test="mfmTxnCde!=null">
				AND MFM_TXN_CDE=#{mfmTxnCde,jdbcType=CHAR}
			</if>
			<if test="mfmTxnSubCde!=null">
				AND MFM_TXN_SUB_CDE=#{mfmTxnSubCde,jdbcType=CHAR}
			</if>
			<if test="acDte!=null">
				AND AC_DTE=#{acDte,jdbcType=DATE}
			</if>
			<if test="mfmVchNo!=null">
				AND MFM_VCH_NO=#{mfmVchNo,jdbcType=CHAR}
			</if>
			<if test="mfmJrnNo!=null">
				AND MFM_JRN_NO=#{mfmJrnNo,jdbcType=CHAR}
			</if>
			<if test="mfmTxnSts!=null">
				AND MFM_TXN_STS=#{mfmTxnSts,jdbcType=CHAR}
			</if>
			<if test="mfmRspCde!=null">
				AND MFM_RSP_CDE=#{mfmRspCde,jdbcType=CHAR}
			</if>
			<if test="mfmRspMsg!=null">
				AND MFM_RSP_MSG=#{mfmRspMsg,jdbcType=VARCHAR}
			</if>
			<if test="thdTxnCde!=null">
				AND THD_TXN_CDE=#{thdTxnCde,jdbcType=CHAR}
			</if>
			<if test="thdTxnDte!=null">
				AND THD_TXN_DTE=#{thdTxnDte,jdbcType=DATE}
			</if>
			<if test="thdTxnTme!=null">
				AND THD_TXN_TME=#{thdTxnTme,jdbcType=TIMESTAMP}
			</if>
			<if test="thdSqn!=null">
				AND THD_SQN=#{thdSqn,jdbcType=CHAR}
			</if>
			<if test="thdTxnSts!=null">
				AND THD_TXN_STS=#{thdTxnSts,jdbcType=CHAR}
			</if>
			<if test="thdRspCde!=null">
				AND THD_RSP_CDE=#{thdRspCde,jdbcType=CHAR}
			</if>
			<if test="thdRspMsg!=null">
				AND THD_RSP_MSG=#{thdRspMsg,jdbcType=CHAR}
			</if>
			<if test="rcnFlg!=null">
				AND RCN_FLG=#{rcnFlg,jdbcType=CHAR}
			</if>
			<if test="mfmDytRcnFlg!=null">
				AND MFM_DYT_RCN_FLG=#{mfmDytRcnFlg,jdbcType=CHAR}
			</if>
			<if test="mfmEodRcnFlg!=null">
				AND MFM_EOD_RCN_FLG=#{mfmEodRcnFlg,jdbcType=CHAR}
			</if>
			<if test="mfmRcnBat!=null">
				AND MFM_RCN_BAT=#{mfmRcnBat,jdbcType=CHAR}
			</if>
			<if test="mfmRcnTme!=null">
				AND MFM_RCN_TME=#{mfmRcnTme,jdbcType=TIMESTAMP}
			</if>
			<if test="thdRcnFlg!=null">
				AND THD_RCN_FLG=#{thdRcnFlg,jdbcType=CHAR}
			</if>
			<if test="thdRcnTme!=null">
				AND THD_RCN_TME=#{thdRcnTme,jdbcType=TIMESTAMP}
			</if>
			<if test="thdRcnBat!=null">
				AND THD_RCN_BAT=#{thdRcnBat,jdbcType=CHAR}
			</if>
			<if test="isBatFlg!=null">
				AND IS_BAT_FLG=#{isBatFlg,jdbcType=CHAR}
			</if>
			<if test="batNo!=null">
				AND BAT_NO=#{batNo,jdbcType=CHAR}
			</if>
			<if test="extRcnFlg!=null">
				AND EXT_RCN_FLG=#{extRcnFlg,jdbcType=CHAR}
			</if>
			<if test="ourOthFlg!=null">
				AND OUR_OTH_FLG=#{ourOthFlg,jdbcType=CHAR}
			</if>
			<if test="thdRgnNo!=null">
				AND THD_RGN_NO=#{thdRgnNo,jdbcType=CHAR}
			</if>
			<if test="thdCusNo!=null">
				AND THD_CUS_NO=#{thdCusNo,jdbcType=CHAR}
			</if>
			<if test="thdCusNme!=null">
				AND THD_CUS_NME=#{thdCusNme,jdbcType=VARCHAR}
			</if>
			<if test="payChl!=null">
				AND PAY_CHL=#{payChl,jdbcType=CHAR}
			</if>
			<if test="splNo!=null">
				AND SPL_NO=#{splNo,jdbcType=CHAR}
			</if>
			<if test="splTerNo!=null">
				AND SPL_TER_NO=#{splTerNo,jdbcType=CHAR}
			</if>
			<if test="txnTyp!=null">
				AND TXN_TYP=#{txnTyp,jdbcType=CHAR}
			</if>
			<if test="cusAc!=null">
				AND CUS_AC=#{cusAc,jdbcType=CHAR}
			</if>
			<if test="cusNme!=null">
				AND CUS_NME=#{cusNme,jdbcType=VARCHAR}
			</if>
			<if test="idTyp!=null">
				AND ID_TYP=#{idTyp,jdbcType=CHAR}
			</if>
			<if test="idNo!=null">
				AND ID_NO=#{idNo,jdbcType=VARCHAR}
			</if>
			<if test="cmuTel!=null">
				AND CMU_TEL=#{cmuTel,jdbcType=VARCHAR}
			</if>
			<if test="accTyp!=null">
				AND ACC_TYP=#{accTyp,jdbcType=CHAR}
			</if>
			<if test="accSeq!=null">
				AND ACC_SEQ=#{accSeq,jdbcType=CHAR}
			</if>
			<if test="bvKnd!=null">
				AND BV_KND=#{bvKnd,jdbcType=CHAR}
			</if>
			<if test="bvNo!=null">
				AND BV_NO=#{bvNo,jdbcType=CHAR}
			</if>
			<if test="lisAcc!=null">
				AND LIS_ACC=#{lisAcc,jdbcType=CHAR}
			</if>
			<if test="choNo!=null">
				AND CHO_NO=#{choNo,jdbcType=CHAR}
			</if>
			<if test="rmkCde!=null">
				AND RMK_CDE=#{rmkCde,jdbcType=CHAR}
			</if>
			<if test="cshNo!=null">
				AND CSH_NO=#{cshNo,jdbcType=CHAR}
			</if>
			<if test="drwMde!=null">
				AND DRW_MDE=#{drwMde,jdbcType=CHAR}
			</if>
			<if test="reqTxnAmt!=null">
				AND REQ_TXN_AMT=#{reqTxnAmt,jdbcType=DECIMAL}
			</if>
			<if test="fulDedFlg!=null">
				AND FUL_DED_FLG=#{fulDedFlg,jdbcType=CHAR}
			</if>
			<if test="hfe!=null">
				AND HFE=#{hfe,jdbcType=DECIMAL}
			</if>
			<if test="hfeItmSeq!=null">
				AND HFE_ITM_SEQ=#{hfeItmSeq,jdbcType=CHAR}
			</if>
			<if test="hfePstBr!=null">
				AND HFE_PST_BR=#{hfePstBr,jdbcType=CHAR}
			</if>
			<if test="prtFlg!=null">
				AND PRT_FLG=#{prtFlg,jdbcType=CHAR}
			</if>
			<if test="prtCnt!=null">
				AND PRT_CNT=#{prtCnt,jdbcType=INTEGER}
			</if>
			<if test="bakFld1!=null">
				AND BAK_FLD1=#{bakFld1,jdbcType=CHAR}
			</if>
			<if test="bakFld2!=null">
				AND BAK_FLD2=#{bakFld2,jdbcType=CHAR}
			</if>
			<if test="bakFld3!=null">
				AND BAK_FLD3=#{bakFld3,jdbcType=CHAR}
			</if>
			<if test="bakFld4!=null">
				AND BAK_FLD4=#{bakFld4,jdbcType=CHAR}
			</if>
			<if test="bakFld5!=null">
				AND BAK_FLD5=#{bakFld5,jdbcType=CHAR}
			</if>
			<if test="bakFld6!=null">
				AND BAK_FLD6=#{bakFld6,jdbcType=CHAR}
			</if>
			<if test="rsvFld1!=null">
				AND RSV_FLD1=#{rsvFld1,jdbcType=VARCHAR}
			</if>
			<if test="rsvFld2!=null">
				AND RSV_FLD2=#{rsvFld2,jdbcType=VARCHAR}
			</if>
			<if test="rsvFld3!=null">
				AND RSV_FLD3=#{rsvFld3,jdbcType=VARCHAR}
			</if>
			<if test="rsvFld4!=null">
				AND RSV_FLD4=#{rsvFld4,jdbcType=VARCHAR}
			</if>
			<if test="rsvFld5!=null">
				AND RSV_FLD5=#{rsvFld5,jdbcType=VARCHAR}
			</if>
			<if test="rsvFld6!=null">
				AND RSV_FLD6=#{rsvFld6,jdbcType=VARCHAR}
			</if>
			<if test="filFlg!=null">
				AND FIL_FLG=#{filFlg,jdbcType=CHAR}
			</if>
		</trim>
	</select>

	<!-- 报表打印—全部 findAllTxnList -->
	<select id="findAllTxnList" resultType="java.util.Map"
		parameterType="com.bocom.bbip.gdeupsb.entity.GdEupsTransJournal">
		select * FROM
		
		(select
		COALESCE(count(*), 0) totCnt, COALESCE(sum(TXN_AMT), 0) totAmt
		from
		eups.EUPS_TRANS_JOURNAL
		where TXN_DTE=#{txnDte,jdbcType=DATE} and
		eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR}  and MFM_TXN_STS !='C' and TXN_TYP!='C') b,
		
		(select COALESCE(count(*),
		0) succCnt, COALESCE(sum(TXN_AMT), 0) totSuccAmt from
		eups.EUPS_TRANS_JOURNAL d where d.TXN_STS='S' AND d.MFM_TXN_STS='S'
		and d.THD_TXN_STS!='F' and d.THD_TXN_STS!='T'
		and d.TXN_DTE=#{txnDte,jdbcType=DATE} and
		d.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and d.TXN_TYP!='C' AND D.MFM_TXN_STS !='C') c,
		
		(select COALESCE(count(*), 0) failCnt, COALESCE(sum(TXN_AMT), 0)
		totFailAmt from
		eups.EUPS_TRANS_JOURNAL where TXN_STS='F' AND
		MFM_TXN_STS='F' and
		TXN_DTE=#{txnDte,jdbcType=DATE} and
		eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and TXN_TYP!='C'AND MFM_TXN_STS !='C') e,
		
		(select
		COALESCE(count(*), 0) doubtCnt, COALESCE(sum(TXN_AMT), 0) totDoubtAmt
		from
		eups.EUPS_TRANS_JOURNAL c where c.MFM_TXN_STS='S' and C.TXN_STS !='S' AND
		c.THD_TXN_STS!='S' and c.THD_TXN_STS!='F'  and c.MFM_TXN_STS!='C' and
		c.TXN_TYP!='C' and c.TXN_DTE=#{txnDte,jdbcType=DATE} and
		c.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR}) d,
		
		(select
		COALESCE(count(*), 0) otherCnt, COALESCE(sum(TXN_AMT), 0) totOtherAmt
		from
		eups.EUPS_TRANS_JOURNAL where 
		sqn not in(select a.sqn from (select
		distinct a.sqn as sqn from eups.EUPS_TRANS_JOURNAL a where
		a.TXN_STS='F' AND a.MFM_TXN_STS='F'  and a.TXN_DTE=#{txnDte,jdbcType=DATE} and
		a.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and a.TXN_TYP!='C' AND A.MFM_TXN_STS!='C') a) and
		
		sqn not in(select b.sqn from(select distinct b.sqn as sqn from
		eups.EUPS_TRANS_JOURNAL b where b.MFM_TXN_STS='S' and B.TXN_STS='S' AND
		b.THD_TXN_STS!='T' and b.THD_TXN_STS!='F' and b.MFM_TXN_STS!='C' and
		b.TXN_TYP!='C' and b.TXN_DTE=#{txnDte,jdbcType=DATE} and
		b.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR})b) and 
		
		sqn not in(select
		c.sqn from(select c.sqn as sqn from eups.EUPS_TRANS_JOURNAL c where
		c.TXN_STS !='S' AND c.MFM_TXN_STS='S'  and
		c.THD_TXN_STS!='F' and c.THD_TXN_STS!='S' and
		c.TXN_DTE=#{txnDte,jdbcType=DATE} and
		c.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and c.TXN_TYP!='C' and MFM_TXN_STS !='C')c) and
		TXN_DTE=#{txnDte,jdbcType=DATE} and
		eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and MFM_TXN_STS !='C' and TXN_TYP!='C') y
	</select>

	<!-- 报表打印—成功 findSuccTxnList -->
	<select id="findSuccTxnList" resultType="java.util.Map"
		parameterType="com.bocom.bbip.gdeupsb.entity.GdEupsTransJournal">
		
select * from
		(select c.* from eups.EUPS_TRANS_JOURNAL c
		where c.TXN_STS='S' AND
		c.MFM_TXN_STS='S'  and
		c.THD_TXN_STS!='F' and
		c.THD_TXN_STS!='T' and
		c.TXN_DTE=#{txnDte,jdbcType=DATE} and
		c.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and c.TXN_TYP!='C'AND C.MFM_TXN_STS !='C') a,
		(select COALESCE(count(*), 0) succCnt, COALESCE(sum(TXN_AMT), 0)
		totSuccAmt from
		eups.EUPS_TRANS_JOURNAL d where d.TXN_STS='S' AND
		d.MFM_TXN_STS='S'
		 and d.THD_TXN_STS!='F' and
		d.THD_TXN_STS!='T'
		and d.TXN_DTE=#{txnDte,jdbcType=DATE} and
		d.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and
		d.TXN_TYP!='C'AND D.MFM_TXN_STS !='C') b order
		by com_no
	</select>

	<!-- 报表打印—失败 findFailTxnList -->
	<select id="findFailTxnList" resultType="java.util.Map"
		parameterType="com.bocom.bbip.gdeupsb.entity.GdEupsTransJournal">
		select * from
		(select * from eups.EUPS_TRANS_JOURNAL
		where TXN_STS='F' AND MFM_TXN_STS='F'
		 and TXN_DTE=#{txnDte,jdbcType=DATE} and
		eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and TXN_TYP!='C' AND MFM_TXN_STS !='C') a,
		(select
		COALESCE(count(*), 0) failCnt, COALESCE(sum(TXN_AMT), 0) totFailAmt
		from
		eups.EUPS_TRANS_JOURNAL
		where TXN_STS='F' AND MFM_TXN_STS='F' and
		TXN_DTE=#{txnDte,jdbcType=DATE} and
		eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and TXN_TYP!='C'AND MFM_TXN_STS !='C') b order by
		com_no
	</select>

	<select id="findElecFailTxnList" resultType="java.util.Map"
		parameterType="com.bocom.bbip.gdeupsb.entity.GdEupsTransJournal">
		<!-- select * from
		(select * from eups.EUPS_TRANS_JOURNAL
		where TXN_STS='F' AND (MFM_TXN_STS='F'
		or (MFM_TXN_STS='S' and
		THD_TXN_STS='F')) and TXN_DTE=#{txnDte,jdbcType=DATE} and
		eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and TXN_TYP!='C') a,
		(select
		COALESCE(count(*), 0) failCnt, COALESCE(sum(TXN_AMT), 0) totFailAmt
		from
		eups.EUPS_TRANS_JOURNAL
		where TXN_STS='F' AND (MFM_TXN_STS='F' or
		(MFM_TXN_STS='S' and
		THD_TXN_STS='F')) and
		TXN_DTE=#{txnDte,jdbcType=DATE} and
		eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and TXN_TYP!='C') b order by
		BAK_FLD2 -->
		SELECT * FROM(
select * from  eups.EUPS_TRANS_JOURNAL A
 where  A.TXN_DTE=#{txnDte,jdbcType=DATE} and A.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} AND A.TXN_TYP !='C' AND A.MFM_TXN_STS !='C'
and 
((
A.CHL_TYP !='90' and A.TXN_STS='F' AND A.MFM_TXN_STS='F' 
) 
or 
(
A.CHL_TYP='90' and A.TXN_STS='F' AND A.MFM_TXN_STS='F' AND A.THD_TXN_STS !='S' 
)) ) C,
(select COALESCE(count(*), 0) failCnt, COALESCE(sum(TXN_AMT), 0) totFailAmt  from  eups.EUPS_TRANS_JOURNAL B
 where  B.TXN_DTE=#{txnDte,jdbcType=DATE} and B.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} AND B.TXN_TYP !='C' AND B.MFM_TXN_STS !='C'
and 
((
B.CHL_TYP !='90' and B.TXN_STS='F' AND B.MFM_TXN_STS='F' 
) 
or 
(
B.CHL_TYP='90' and B.TXN_STS='F' AND B.MFM_TXN_STS='F' AND B.THD_TXN_STS !='S' 
)) ) D  ORDER BY bak_fld2
	</select>

	<!-- 报表打印—可疑 findDoubtTxnList -->
	<select id="findDoubtTxnList" resultType="java.util.Map"
		parameterType="com.bocom.bbip.gdeupsb.entity.GdEupsTransJournal">
		select * FROM
		(select a.* from eups.EUPS_TRANS_JOURNAL a
		where a.MFM_TXN_STS='S' and A.TXN_STS !='S' AND
		a.THD_TXN_STS!='S' and a.THD_TXN_STS!='F' 
		and a.MFM_TXN_STS!='C' and
		a.TXN_TYP!='C'AND 
		a.TXN_DTE=#{txnDte,jdbcType=DATE} and
		a.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR})
		b,
		(select
		COALESCE(count(*), 0)
		doubtCnt, COALESCE(sum(TXN_AMT), 0) totDoubtAmt
		from
		eups.EUPS_TRANS_JOURNAL c where
		c.MFM_TXN_STS='S' and C.TXN_STS !='S' AND
		c.THD_TXN_STS!='S' and c.THD_TXN_STS!='F' and c.THD_TXN_STS!='U'
		and
		c.MFM_TXN_STS!='C' and
		c.TXN_TYP!='C' and
		c.TXN_DTE=#{txnDte,jdbcType=DATE} and
		c.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR})
		d order by com_no
	</select>

	<select id="findElecDoubtTxnList" resultType="java.util.Map"
		parameterType="com.bocom.bbip.gdeupsb.entity.GdEupsTransJournal">
		<!-- select * FROM
		(select a.* from eups.EUPS_TRANS_JOURNAL a
		where a.MFM_TXN_STS='S' and
		a.THD_TXN_STS!='S' and a.THD_TXN_STS!='F'
		and a.MFM_TXN_STS!='C' and
		a.TXN_TYP!='C' and
		a.TXN_DTE=#{txnDte,jdbcType=DATE} and
		a.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR})
		b,
		(select
		COALESCE(count(*), 0)
		doubtCnt, COALESCE(sum(TXN_AMT), 0) totDoubtAmt
		from
		eups.EUPS_TRANS_JOURNAL c where
		c.MFM_TXN_STS='S' and
		c.THD_TXN_STS!='S' and c.THD_TXN_STS!='F' and
		c.MFM_TXN_STS!='C' and
		c.TXN_TYP!='C' and
		c.TXN_DTE=#{txnDte,jdbcType=DATE} and
		c.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR})
		d order by BAK_FLD2 -->
		
		SELECT * FROM(
select * from  eups.EUPS_TRANS_JOURNAL A
 where  A.TXN_DTE=#{txnDte,jdbcType=DATE} and A.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} AND A.TXN_TYP !='C' AND A.MFM_TXN_STS !='C'
and 
A.CHL_TYP !='90' and A.TXN_STS !='S' AND A.MFM_TXN_STS='S' AND A.THD_TXN_STS !='S' AND A.THD_TXN_STS !='F' 
) C,
(select COALESCE(count(*), 0)
		doubtCnt, COALESCE(sum(TXN_AMT), 0) totDoubtAmt  from  eups.EUPS_TRANS_JOURNAL B
 where  B.TXN_DTE=#{txnDte,jdbcType=DATE} and B.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} AND B.TXN_TYP !='C' AND B.MFM_TXN_STS !='C'
and 
B.CHL_TYP !='90' and B.TXN_STS !='S' AND B.MFM_TXN_STS='S' AND B.THD_TXN_STS !='S' AND B.THD_TXN_STS !='F'
 ) D  ORDER BY bak_fld2
	</select>
	<!-- 报表打印—其他 findOthTxnList -->
	<select id="findOthTxnList" resultType="java.util.Map"
		parameterType="com.bocom.bbip.gdeupsb.entity.GdEupsTransJournal">
		
		select * from
		(select * from eups.EUPS_TRANS_JOURNAL
		where sqn not in(select a.sqn from
		(select distinct a.sqn as sqn from
		eups.EUPS_TRANS_JOURNAL a where
		a.TXN_STS='F' AND a.MFM_TXN_STS='F'  and
		a.TXN_DTE=#{txnDte,jdbcType=DATE} and
		a.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and a.TXN_TYP!='C' AND A.MFM_TXN_STS !='C' ) a) and
		sqn not in(select
		b.sqn from(select distinct b.sqn as sqn from
		eups.EUPS_TRANS_JOURNAL b
		where b.MFM_TXN_STS='S' and B.TXN_STS='S'  and b.THD_TXN_STS!='F'  and b.THD_TXN_STS!='T'
		and b.MFM_TXN_STS!='C' and
		b.TXN_TYP!='C' and b.TXN_DTE=#{txnDte,jdbcType=DATE}
		and
		b.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR})b) and sqn not in(select
		c.sqn from(select
		c.sqn as sqn from eups.EUPS_TRANS_JOURNAL c where
		c.TXN_STS !='S' AND
		c.MFM_TXN_STS='S' and c.THD_TXN_STS!='S' and
		c.THD_TXN_STS!='F'  and
		c.TXN_DTE=#{txnDte,jdbcType=DATE} and
		c.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and c.TXN_TYP!='C')c) and
		TXN_DTE=#{txnDte,jdbcType=DATE}
		and
		eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and MFM_TXN_STS !='C' and TXN_TYP!='C') x,
		(select COALESCE(count(*),
		0) otherCnt,
		COALESCE(sum(TXN_AMT), 0) totOtherAmt from
		eups.EUPS_TRANS_JOURNAL where sqn not in(select a.sqn from
		(select distinct a.sqn as sqn from
		eups.EUPS_TRANS_JOURNAL a where
		a.TXN_STS='F' AND a.MFM_TXN_STS='F'  and
		a.TXN_DTE=#{txnDte,jdbcType=DATE} and
		a.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and a.TXN_TYP!='C' AND A.MFM_TXN_STS !='C' ) a) and
		sqn not in(select
		b.sqn from(select distinct b.sqn as sqn from
		eups.EUPS_TRANS_JOURNAL b
		where b.MFM_TXN_STS='S' and B.TXN_STS='S'  and b.THD_TXN_STS!='F'  and b.THD_TXN_STS!='T'
		and b.MFM_TXN_STS!='C' and
		b.TXN_TYP!='C' and b.TXN_DTE=#{txnDte,jdbcType=DATE}
		and
		b.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR})b) and sqn not in(select
		c.sqn from(select
		c.sqn as sqn from eups.EUPS_TRANS_JOURNAL c where
		c.TXN_STS !='S' AND
		c.MFM_TXN_STS='S' and c.THD_TXN_STS!='S' and
		c.THD_TXN_STS!='F'  and
		c.TXN_DTE=#{txnDte,jdbcType=DATE} and
		c.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and c.TXN_TYP!='C')c) and
		TXN_DTE=#{txnDte,jdbcType=DATE}
		and
		eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and MFM_TXN_STS !='C' and TXN_TYP!='C') y order by com_no
		
	</select>

	<select id="findElecOthTxnList" resultType="java.util.Map"
		parameterType="com.bocom.bbip.gdeupsb.entity.GdEupsTransJournal">
		<!-- select * from
		(select * from eups.EUPS_TRANS_JOURNAL
		where sqn not in(select a.sqn from
		(select distinct a.sqn as sqn from
		eups.EUPS_TRANS_JOURNAL a where
		a.TXN_STS='F' AND (a.MFM_TXN_STS='F' or
		(a.MFM_TXN_STS='S' and
		a.THD_TXN_STS='F')) and
		a.TXN_DTE=#{txnDte,jdbcType=DATE} and
		a.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and a.TXN_TYP!='C') a) and
		sqn not in(select
		b.sqn from(select distinct b.sqn as sqn from
		eups.EUPS_TRANS_JOURNAL b
		where b.MFM_TXN_STS='S' and
		b.THD_TXN_STS!='S' and b.THD_TXN_STS!='F'
		and b.MFM_TXN_STS!='C' and
		b.TXN_TYP!='C' and b.TXN_DTE=#{txnDte,jdbcType=DATE}
		and
		b.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR})b) and sqn not in(select
		c.sqn from(select
		c.sqn as sqn from eups.EUPS_TRANS_JOURNAL c where
		c.TXN_STS='S' AND
		c.MFM_TXN_STS='S' and c.THD_TXN_STS!='U' and
		c.THD_TXN_STS!='F' and
		c.THD_TXN_STS!='T' and
		c.TXN_DTE=#{txnDte,jdbcType=DATE} and
		c.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and c.TXN_TYP!='C')c) and
		TXN_DTE=#{txnDte,jdbcType=DATE}
		and
		eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR}) x,
		(select COALESCE(count(*),
		0) otherCnt,
		COALESCE(sum(TXN_AMT), 0) totOtherAmt from
		eups.EUPS_TRANS_JOURNAL where sqn not
		in(select a.sqn from (select
		distinct a.sqn as sqn from
		eups.EUPS_TRANS_JOURNAL a where
		a.TXN_STS='F' AND (a.MFM_TXN_STS='F' or
		(a.MFM_TXN_STS='S' and
		a.THD_TXN_STS='F')) and
		a.TXN_DTE=#{txnDte,jdbcType=DATE} and
		a.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and a.TXN_TYP!='C') a) and
		sqn not in(select
		b.sqn from(select distinct b.sqn as sqn from
		eups.EUPS_TRANS_JOURNAL b
		where b.MFM_TXN_STS='S' and
		b.THD_TXN_STS!='S' and b.THD_TXN_STS!='F'
		and b.MFM_TXN_STS!='C' and
		b.TXN_TYP!='C' and b.TXN_DTE=#{txnDte,jdbcType=DATE}
		and
		b.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR})b) and sqn not in(select
		c.sqn from(select
		c.sqn as sqn from eups.EUPS_TRANS_JOURNAL c where
		c.TXN_STS='S' AND
		c.MFM_TXN_STS='S' and c.THD_TXN_STS!='U' and
		c.THD_TXN_STS!='F' and
		c.THD_TXN_STS!='T' and
		c.TXN_DTE=#{txnDte,jdbcType=DATE} and
		c.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and c.TXN_TYP!='C')c) and
		TXN_DTE=#{txnDte,jdbcType=DATE}
		and
		eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR}) y order by BAK_FLD2 -->
		
		select * from 
(select * from eups.EUPS_TRANS_JOURNAL
where sqn not in(
 
select distinct a.sqn as sqn from  eups.EUPS_TRANS_JOURNAL A
 where  A.TXN_DTE=#{txnDte,jdbcType=DATE} and A.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} AND A.TXN_TYP !='C' AND A.MFM_TXN_STS !='C'
and 
((
A.CHL_TYP !='90' and A.TXN_STS='S' AND A.MFM_TXN_STS='S' AND A.THD_TXN_STS='S' 
) 
or 
(
A.CHL_TYP='90' and A.TXN_STS='S' AND A.MFM_TXN_STS='S' AND A.THD_TXN_STS !='F'  AND A.THD_TXN_STS !='T'  AND A.THD_TXN_STS !='R'
))

) 
and sqn not in(
	
select distinct a.sqn as sqn from  eups.EUPS_TRANS_JOURNAL A
 where  A.TXN_DTE=#{txnDte,jdbcType=DATE} and A.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} AND A.TXN_TYP !='C' AND A.MFM_TXN_STS !='C'
and 
((
A.CHL_TYP !='90' and A.TXN_STS='F' AND A.MFM_TXN_STS='F' 
) 
or 
(
A.CHL_TYP='90' and A.TXN_STS='F' AND A.MFM_TXN_STS='F' 
))
	
) 
and sqn not in(

select distinct a.sqn as sqn from  eups.EUPS_TRANS_JOURNAL A
 where  A.TXN_DTE=#{txnDte,jdbcType=DATE} and A.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} AND A.TXN_TYP !='C' AND A.MFM_TXN_STS !='C'
and 
A.CHL_TYP !='90' and A.TXN_STS !='S' AND A.MFM_TXN_STS='S'  AND A.THD_TXN_STS !='S' AND A.THD_TXN_STS !='F'


) 
and TXN_DTE=#{txnDte,jdbcType=DATE} and eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} AND TXN_TYP !='C' AND MFM_TXN_STS !='C') x,

(select  COALESCE(count(*),
		0) otherCnt,
		COALESCE(sum(TXN_AMT), 0) totOtherAmt from eups.EUPS_TRANS_JOURNAL
where sqn not in(
 
select distinct a.sqn as sqn from  eups.EUPS_TRANS_JOURNAL A
 where  A.TXN_DTE=#{txnDte,jdbcType=DATE} and A.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} AND A.TXN_TYP !='C' AND A.MFM_TXN_STS !='C'
and 
((
A.CHL_TYP !='90' and A.TXN_STS='S' AND A.MFM_TXN_STS='S' AND A.THD_TXN_STS='S' 
) 
or 
(
A.CHL_TYP='90' and A.TXN_STS='S' AND A.MFM_TXN_STS='S' AND A.THD_TXN_STS !='F'  AND A.THD_TXN_STS !='T'  AND A.THD_TXN_STS !='R'
))

) 
and sqn not in(
	
select distinct a.sqn as sqn from  eups.EUPS_TRANS_JOURNAL A
 where  A.TXN_DTE=#{txnDte,jdbcType=DATE} and A.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} AND A.TXN_TYP !='C' AND A.MFM_TXN_STS !='C'
and 
((
A.CHL_TYP !='90' and A.TXN_STS='F' AND A.MFM_TXN_STS='F' 
) 
or 
(
A.CHL_TYP='90' and A.TXN_STS='F' AND A.MFM_TXN_STS='F' 
))
	
) 
and sqn not in(

select distinct a.sqn as sqn from  eups.EUPS_TRANS_JOURNAL A
 where  A.TXN_DTE=#{txnDte,jdbcType=DATE} and A.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} AND A.TXN_TYP !='C' AND A.MFM_TXN_STS !='C'
and 
A.CHL_TYP !='90' and A.TXN_STS !='S' AND A.MFM_TXN_STS='S' AND A.THD_TXN_STS !='S' AND A.THD_TXN_STS !='F' 


) 
and TXN_DTE=#{txnDte,jdbcType=DATE} and eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} AND TXN_TYP !='C' AND MFM_TXN_STS !='C') y		
		
	</select>

	<!-- 流水信息查询 -->
	<select id="findTxnJnlInfo" resultType="java.util.Map"
		parameterType="com.bocom.bbip.gdeupsb.entity.GdEupsTransJournal">
		select
		<include refid="baseColumnList" />
		from ${EUPS_SCHEMA}.EUPS_TRANS_JOURNAL
		<trim prefix="WHERE" prefixOverrides="AND">
			<if test="sqn!=null">
				AND SQN=#{sqn,jdbcType=CHAR}
			</if>
			<if test="mfmVchNo!=null">
				AND MFM_VCH_NO=#{mfmVchNo,jdbcType=CHAR}
			</if>
			<if test="thdRgnNo!=null">
				AND THD_RGN_NO=#{thdRgnNo,jdbcType=CHAR}
			</if>
			<if test="thdCusNo!=null">
				AND THD_CUS_NO=#{thdCusNo,jdbcType=CHAR}
			</if>
			<if test="cusAc!=null">
				AND CUS_AC=#{cusAc,jdbcType=CHAR}
			</if>
			<if test="chlTyp != null">
				AND CHL_TYP = #{chlTyp,jdbcType=CHAR}
			</if>
			<if test="tmlNo != null">
				AND TML_NO = #{tmlNo,jdbcType=CHAR}
			</if>
			<if test="busKnd != null">
				AND BUS_KND = #{busKnd,jdbcType=CHAR}
			</if>
			<if test="eupsBusTyp != null">
				AND EUPS_BUS_TYP = #{eupsBusTyp,jdbcType=CHAR}
			</if>
			<if test="txnSts != null">
				AND TXN_STS = #{txnSts,jdbcType=CHAR}
			</if>
			<if test="comNo != null">
				AND COM_NO = #{comNo,jdbcType=CHAR}
			</if>
			<if test="beginDate!=null">
				AND TXN_DTE &gt;=#{beginDate,jdbcType=DATE}
			</if>
			<if test="endDate!=null">
				AND TXN_DTE &lt;=#{endDate,jdbcType=DATE}
			</if>
		</trim>
	</select>

	<select id="findTxnJnlInfoCount" resultType="java.lang.Integer">
		select
		count(*)
		from ${EUPS_SCHEMA}.EUPS_TRANS_JOURNAL
		<trim prefix="WHERE" prefixOverrides="AND">
			<if test="sqn!=null">
				AND SQN=#{sqn,jdbcType=CHAR}
			</if>
			<if test="mfmVchNo!=null">
				AND MFM_VCH_NO=#{mfmVchNo,jdbcType=CHAR}
			</if>
			<if test="thdRgnNo!=null">
				AND THD_RGN_NO=#{thdRgnNo,jdbcType=CHAR}
			</if>
			<if test="thdCusNo!=null">
				AND THD_CUS_NO=#{thdCusNo,jdbcType=CHAR}
			</if>
			<if test="cusAc!=null">
				AND CUS_AC=#{cusAc,jdbcType=CHAR}
			</if>
			<if test="chlTyp != null">
				AND CHL_TYP = #{chlTyp,jdbcType=CHAR}
			</if>
			<if test="tmlNo != null">
				AND TML_NO = #{tmlNo,jdbcType=CHAR}
			</if>
			<if test="busKnd != null">
				AND BUS_KND = #{busKnd,jdbcType=CHAR}
			</if>
			<if test="eupsBusTyp != null">
				AND EUPS_BUS_TYP = #{eupsBusTyp,jdbcType=CHAR}
			</if>
			<if test="txnSts != null">
				AND TXN_STS = #{txnSts,jdbcType=CHAR}
			</if>
			<if test="comNo != null">
				AND COM_NO = #{comNo,jdbcType=CHAR}
			</if>
			<if test="beginDate!=null">
				AND TXN_DTE &gt;=#{beginDate,jdbcType=DATE}
			</if>
			<if test="endDate!=null">
				AND TXN_DTE &lt;=#{endDate,jdbcType=DATE}
			</if>
		</trim>
	</select>

	<!-- 查询广州电力清算流水信息 -->
	<select id="findGzClrJnl" resultType="java.util.Map"
		parameterType="com.bocom.bbip.gdeupsb.entity.GdEupsTransJournal">
		select
		sum(TXN_AMT) TXNAMT,count(*) TXNCNT
		from
		${EUPS_SCHEMA}.EUPS_TRANS_JOURNAL where EUPS_BUS_TYP='ELEC01' and
		MFM_TXN_STS='S' and TXN_STS='S'
		and BAK_FLD1=#{bakFld1,jdbcType=CHAR}
		and (THD_TXN_CDE='HK' or THD_TXN_CDE='JF')
	</select>


	<!-- 查询广州电力划扣明确成功信息 -->
	<select id="findGzSucJnlHK" resultType="java.util.Map"
		parameterType="com.bocom.bbip.gdeupsb.entity.GdEupsTransJournal">
		select
		sum(TXN_AMT) TXNAMT,count(*) TXNCNT
		from
		${EUPS_SCHEMA}.EUPS_TRANS_JOURNAL where EUPS_BUS_TYP='ELEC01' and
		MFM_TXN_STS='S' and TXN_STS='S' and TXN_TYP='N'
		and
		BAK_FLD1=#{bakFld1,jdbcType=CHAR}
		and THD_TXN_CDE='HK'
	</select>

	<!-- 查找广州电力总笔数，金额 -->
	<select id="findGzAllCntAmt" resultType="java.util.Map"
		parameterType="com.bocom.bbip.gdeupsb.entity.GdEupsTransJournal">
		select
		sum(TXN_AMT) allAmt ,count(*) allCnt
		from
		${EUPS_SCHEMA}.EUPS_TRANS_JOURNAL where EUPS_BUS_TYP='ELEC01'
		and BAK_FLD1=#{bakFld1,jdbcType=CHAR}
		and TXN_TYP!='C' and
		TXN_STS!='C' and
		MFM_TXN_STS!='C'
	</select>


	<!-- 查询广州电力缴费明确成功信息 -->
	<select id="findGzSucJnlJF" resultType="java.util.Map"
		parameterType="com.bocom.bbip.gdeupsb.entity.GdEupsTransJournal">
		select
		sum(TXN_AMT) TXNAMT,count(*) TXNCNT
		from
		${EUPS_SCHEMA}.EUPS_TRANS_JOURNAL where EUPS_BUS_TYP='ELEC01' and
		MFM_TXN_STS='S' and TXN_STS='S' and TXN_TYP='N' and THD_TXN_STS='S'
		and BAK_FLD1=#{bakFld1,jdbcType=CHAR}
		and THD_TXN_CDE='JF'
	</select>

	<!-- 查询广州电力明确失败信息 -->
	<select id="findGzFalJnl" resultType="java.util.Map"
		parameterType="com.bocom.bbip.gdeupsb.entity.GdEupsTransJournal">
		select
		sum(TXN_AMT) TXNAMT,count(*) TXNCNT
		from
		${EUPS_SCHEMA}.EUPS_TRANS_JOURNAL where EUPS_BUS_TYP='ELEC01' and
		MFM_TXN_STS='F' and TXN_STS='F' and TXN_TYP='N'
		and
		BAK_FLD1=#{bakFld1,jdbcType=CHAR}
		and (THD_TXN_CDE='HK' or
		THD_TXN_CDE='JF')
	</select>

	<!-- 查询存疑，主机交易状态为成功，第三方交易状态不成功 -->
	<select id="findGzUnsJnl" resultType="java.util.Map"
		parameterType="com.bocom.bbip.gdeupsb.entity.GdEupsTransJournal">
		select
		sum(TXN_AMT) TXNAMT,count(*) TXNCNT
		from
		${EUPS_SCHEMA}.EUPS_TRANS_JOURNAL where EUPS_BUS_TYP='ELEC01' and
		MFM_TXN_STS='S' and THD_TXN_STS!='S' and THD_TXN_STS!='F' and
		TXN_STS!='S'
		and BAK_FLD1=#{bakFld1,jdbcType=CHAR} and TXN_TYP='N' and
		THD_TXN_CDE='JF'
	</select>

	<!-- 查询广州电力当日所有明细流水 -->
	<select id="findGdJnlDetail" resultType="java.util.Map"
		parameterType="com.bocom.bbip.gdeupsb.entity.GdEupsTransJournal">
		select
		SQN,TXN_DTE,TXN_TME,TXN_TLR,BR,THD_CUS_NO,CUS_AC,CUS_NME,TXN_AMT,MFM_VCH_NO,RSP_CDE,RSP_MSG,MFM_RSP_CDE,MFM_RSP_MSG,THD_TXN_CDE,THD_TXN_DTE,THD_TXN_TME,
		THD_SQN,BAK_FLD1 from
		${EUPS_SCHEMA}.EUPS_TRANS_JOURNAL where
		EUPS_BUS_TYP='ELEC01' and
		BAK_FLD1=#{bakFld1,jdbcType=CHAR}
		and
		(THD_TXN_CDE='HK' or THD_TXN_CDE='JF') and TXN_TYP!='C' and
		TXN_STS!='C' and MFM_TXN_STS!='C'
	</select>

	<!-- 查询广州电力当日所有流水汇总 -->
	<select id="findGdJnlDtlTot" resultType="java.util.Map"
		parameterType="com.bocom.bbip.gdeupsb.entity.GdEupsTransJournal">
		select * FROM
		(select
		COALESCE(count(*), 0) totCnt,
		COALESCE(sum(TXN_AMT), 0) totAmt from
		eups.EUPS_TRANS_JOURNAL
		where
		BAK_FLD1=#{bakFld1,jdbcType=CHAR} and
		eups_bus_typ='ELEC01') b,
		(select
		COALESCE(count(*),
		0) sucCnt, COALESCE(sum(TXN_AMT), 0) totSucAmt from
		eups.EUPS_TRANS_JOURNAL d where d.TXN_STS='S' AND d.MFM_TXN_STS='S'
		and d.THD_TXN_STS!='U' and d.THD_TXN_STS!='F' and d.THD_TXN_STS!='T'
		and d.BAK_FLD1=#{bakFld1,jdbcType=CHAR} and
		d.eups_bus_typ='ELEC01' and
		d.TXN_TYP!='C') c,
		(select COALESCE(count(*), 0) failCnt,
		COALESCE(sum(TXN_AMT), 0)
		totFailAmt from
		eups.EUPS_TRANS_JOURNAL where
		TXN_STS='F' AND
		(MFM_TXN_STS='F' or
		(MFM_TXN_STS='S' and
		THD_TXN_STS='F')) and
		BAK_FLD1=#{bakFld1,jdbcType=CHAR} and
		eups_bus_typ='ELEC01' and TXN_TYP!='C') e,
		(select
		COALESCE(count(*), 0)
		doubtCnt, COALESCE(sum(TXN_AMT), 0) totDoubtAmt
		from
		eups.EUPS_TRANS_JOURNAL c where c.MFM_TXN_STS='S' and
		c.THD_TXN_STS!='S' and c.THD_TXN_STS!='F' and c.MFM_TXN_STS!='C' and
		c.TXN_TYP!='C' and c.BAK_FLD1=#{bakFld1,jdbcType=CHAR} and
		c.eups_bus_typ='ELEC01') d,
		(select
		COALESCE(count(*), 0) otherCnt,
		COALESCE(sum(TXN_AMT), 0) totOtherAmt
		from
		eups.EUPS_TRANS_JOURNAL where
		sqn not in(select a.sqn from (select
		distinct a.sqn as sqn from
		eups.EUPS_TRANS_JOURNAL a where
		a.TXN_STS='F' AND (a.MFM_TXN_STS='F' or
		(a.MFM_TXN_STS='S' and
		a.THD_TXN_STS='F')) and
		a.BAK_FLD1=#{bakFld1,jdbcType=CHAR} and
		a.eups_bus_typ='ELEC01' and
		a.TXN_TYP!='C') a) and
		sqn not in(select b.sqn from(select distinct
		b.sqn as sqn from
		eups.EUPS_TRANS_JOURNAL b where b.MFM_TXN_STS='S' and
		b.THD_TXN_STS!='S' and b.THD_TXN_STS!='F' and b.MFM_TXN_STS!='C' and
		b.TXN_TYP!='C' and b.BAK_FLD1=#{bakFld1,jdbcType=CHAR} and
		b.eups_bus_typ='ELEC01')b) and sqn not in(select
		c.sqn from(select
		c.sqn as sqn from eups.EUPS_TRANS_JOURNAL c where
		c.TXN_STS='S' AND
		c.MFM_TXN_STS='S' and c.THD_TXN_STS!='U' and
		c.THD_TXN_STS!='F' and
		c.THD_TXN_STS!='T' and
		c.BAK_FLD1=#{bakFld1,jdbcType=CHAR} and
		c.eups_bus_typ='ELEC01' and c.TXN_TYP!='C')c) and
		BAK_FLD1=#{bakFld1,jdbcType=CHAR} and
		eups_bus_typ='ELEC01') y
	</select>

	<!-- 查询广州电力当日所有明细流水 -->
	<select id="findGdJnlAllDetail" resultType="java.util.Map"
		parameterType="com.bocom.bbip.gdeupsb.entity.GdEupsTransJournal">
		select
		* from
		${EUPS_SCHEMA}.EUPS_TRANS_JOURNAL where
		EUPS_BUS_TYP='ELEC01' and
		BAK_FLD1=#{bakFld1,jdbcType=CHAR}
		and
		TXN_TYP!='C' and
		TXN_STS!='C' and MFM_TXN_STS!='C'
	</select>


	<!-- 查找广州电力划扣成功的明细 -->
	<select id="findGdJnlSucHkDetail" resultType="java.util.Map"
		parameterType="com.bocom.bbip.gdeupsb.entity.GdEupsTransJournal">
		select
		*
		from
		${EUPS_SCHEMA}.EUPS_TRANS_JOURNAL where
		EUPS_BUS_TYP='ELEC01' and
		MFM_TXN_STS='S' and TXN_STS='S' and
		TXN_TYP='N'
		and
		BAK_FLD1=#{bakFld1,jdbcType=CHAR}
		and THD_TXN_CDE='HK'
	</select>

	<!-- 查找广州电力缴费成功的明细 -->
	<select id="findGdJnlSucJfDetail" resultType="java.util.Map"
		parameterType="com.bocom.bbip.gdeupsb.entity.GdEupsTransJournal">
		select
		*
		from
		${EUPS_SCHEMA}.EUPS_TRANS_JOURNAL where
		EUPS_BUS_TYP='ELEC01' and
		MFM_TXN_STS='S' and TXN_STS='S' and
		TXN_TYP='N' and THD_TXN_STS='S'
		and BAK_FLD1=#{bakFld1,jdbcType=CHAR}
		and THD_TXN_CDE='JF'
	</select>

	<!-- 查找广州电力失败的明细 -->
	<select id="findGdJnlFalDetail" resultType="java.util.Map"
		parameterType="com.bocom.bbip.gdeupsb.entity.GdEupsTransJournal">
		select * from
		(select * from eups.EUPS_TRANS_JOURNAL
		where TXN_STS='F' AND (MFM_TXN_STS='F'
		or (MFM_TXN_STS='S' and
		THD_TXN_STS='F')) and BAK_FLD1=#{bakFld1,jdbcType=CHAR} and
		eups_bus_typ='ELEC01' and TXN_TYP!='C') a,
		(select
		COALESCE(count(*), 0)
		failCnt, COALESCE(sum(TXN_AMT), 0) totFailAmt
		from
		eups.EUPS_TRANS_JOURNAL
		where TXN_STS='F' AND (MFM_TXN_STS='F' or
		(MFM_TXN_STS='S' and
		THD_TXN_STS='F')) and
		BAK_FLD1=#{bakFld1,jdbcType=CHAR} and
		eups_bus_typ='ELEC01' and
		TXN_TYP!='C') b
	</select>

	<!-- 查找广州电力存疑的明细 -->
	<select id="findGdJnlUnsDetail" resultType="java.util.Map"
		parameterType="com.bocom.bbip.gdeupsb.entity.GdEupsTransJournal">
		select * FROM
		(select a.* from eups.EUPS_TRANS_JOURNAL a
		where a.MFM_TXN_STS='S' and
		a.THD_TXN_STS!='S' and a.THD_TXN_STS!='F'
		and a.MFM_TXN_STS!='C' and
		a.TXN_TYP!='C' and
		a.BAK_FLD1=#{bakFld1,jdbcType=CHAR} and
		a.eups_bus_typ='ELEC01')
		b,
		(select
		COALESCE(count(*), 0)
		doubtCnt, COALESCE(sum(TXN_AMT), 0)
		totDoubtAmt
		from
		eups.EUPS_TRANS_JOURNAL c where
		c.MFM_TXN_STS='S' and
		c.THD_TXN_STS!='S' and c.THD_TXN_STS!='F' and
		c.MFM_TXN_STS!='C' and
		c.TXN_TYP!='C' and
		c.BAK_FLD1=#{bakFld1,jdbcType=CHAR} and
		c.eups_bus_typ='ELEC01')
		d
	</select>

	<!-- 查找广州电力其他的情况 -->
	<select id="findGdJnlOthDetail" resultType="java.util.Map"
		parameterType="com.bocom.bbip.gdeupsb.entity.GdEupsTransJournal">
		select * from
		(select * from eups.EUPS_TRANS_JOURNAL
		where sqn not in(select a.sqn from
		(select distinct a.sqn as sqn from
		eups.EUPS_TRANS_JOURNAL a where
		a.TXN_STS='F' AND (a.MFM_TXN_STS='F' or
		(a.MFM_TXN_STS='S' and
		a.THD_TXN_STS='F')) and
		a.TXN_DTE=#{txnDte,jdbcType=DATE} and
		a.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and a.TXN_TYP!='C') a) and
		sqn not in(select
		b.sqn from(select distinct b.sqn as sqn from
		eups.EUPS_TRANS_JOURNAL b
		where b.MFM_TXN_STS='S' and
		b.THD_TXN_STS!='S' and b.THD_TXN_STS!='F'
		and b.MFM_TXN_STS!='C' and
		b.TXN_TYP!='C' and b.TXN_DTE=#{txnDte,jdbcType=DATE}
		and
		b.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR})b) and sqn not in(select
		c.sqn from(select
		c.sqn as sqn from eups.EUPS_TRANS_JOURNAL c where
		c.TXN_STS='S' AND
		c.MFM_TXN_STS='S' and c.THD_TXN_STS!='U' and
		c.THD_TXN_STS!='F' and
		c.THD_TXN_STS!='T' and
		c.TXN_DTE=#{txnDte,jdbcType=DATE} and
		c.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and c.TXN_TYP!='C')c) and
		TXN_DTE=#{txnDte,jdbcType=DATE}
		and
		eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR}) x,
		(select COALESCE(count(*),
		0) otherCnt,
		COALESCE(sum(TXN_AMT), 0) totOtherAmt from
		eups.EUPS_TRANS_JOURNAL where sqn not
		in(select a.sqn from (select
		distinct a.sqn as sqn from
		eups.EUPS_TRANS_JOURNAL a where
		a.TXN_STS='F' AND (a.MFM_TXN_STS='F' or
		(a.MFM_TXN_STS='S' and
		a.THD_TXN_STS='F')) and
		a.TXN_DTE=#{txnDte,jdbcType=DATE} and
		a.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and a.TXN_TYP!='C') a) and
		sqn not in(select
		b.sqn from(select distinct b.sqn as sqn from
		eups.EUPS_TRANS_JOURNAL b
		where b.MFM_TXN_STS='S' and
		b.THD_TXN_STS!='S' and b.THD_TXN_STS!='F'
		and b.MFM_TXN_STS!='C' and
		b.TXN_TYP!='C' and b.TXN_DTE=#{txnDte,jdbcType=DATE}
		and
		b.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR})b) and sqn not in(select
		c.sqn from(select
		c.sqn as sqn from eups.EUPS_TRANS_JOURNAL c where
		c.TXN_STS='S' AND
		c.MFM_TXN_STS='S' and c.THD_TXN_STS!='U' and
		c.THD_TXN_STS!='F' and
		c.THD_TXN_STS!='T' and
		c.TXN_DTE=#{txnDte,jdbcType=DATE} and
		c.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and c.TXN_TYP!='C')c) and
		TXN_DTE=#{txnDte,jdbcType=DATE}
		and
		eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR}) y
	</select>


	<!-- 查找广州电力存疑的明细 -->
	<!-- <select id="findGdJnlUnsDetail" resultType="java.util.Map" parameterType="com.bocom.bbip.gdeupsb.entity.GdEupsTransJournal"> 
		select SQN,TXN_DTE,TXN_TME,TXN_TLR,BR,THD_CUS_NO,CUS_AC,CUS_NME,TXN_AMT,MFM_VCH_NO,RSP_CDE,RSP_MSG,MFM_RSP_CDE,MFM_RSP_MSG,THD_TXN_CDE,THD_TXN_DTE,THD_TXN_TME, 
		THD_SQN,BAK_FLD1 from ${EUPS_SCHEMA}.EUPS_TRANS_JOURNAL where EUPS_BUS_TYP='ELEC01' 
		and MFM_TXN_STS='S' and THD_TXN_STS!='S' and THD_TXN_STS!='F' and TXN_STS!='S' 
		and BAK_FLD1=#{bakFld1,jdbcType=CHAR} and TXN_TYP='N' and THD_TXN_CDE='JF' 
		</select> -->




	<!-- 财务对账:查询广州电力主机成功流水 -->
	<select id="findGzEleHstSucJnl" resultType="java.util.Map"
		parameterType="java.util.Map">
		select AC_DTE acDte,THD_TXN_CDE thdTxnCde,TXN_AMT
		txnAmt,br,TXN_TLR txnTlr from ${EUPS_SCHEMA}.EUPS_TRANS_JOURNAL
		where
		COM_NO in
		(#{cAgtNoPl,jdbcType=CHAR},#{cAgtNoDl,jdbcType=CHAR},#{cAgtNoYh,jdbcType=CHAR})
		AND AC_DTE=#{acDte,jdbcType=CHAR} AND MFM_TXN_STS='S'
	</select>

	<!-- 燃气报表打印—成功 findGasSucJnlInfo -->
	<select id="findGasSucJnlInfo" resultType="java.util.Map"
		parameterType="java.util.Map">
		select * from
		(select c.* from eups.EUPS_TRANS_JOURNAL c
		where c.TXN_STS='S' AND
		c.MFM_TXN_STS='S' and c.THD_TXN_STS!='U' and
		c.THD_TXN_STS!='F' and
		c.THD_TXN_STS!='T' and
		c.TXN_DTE &gt;=#{beginDte}
		and
		c.TXN_DTE &lt;=#{endDte} and
		c.COM_NO=#{comNo} and c.TXN_TYP!='C')
		a,
		(select COALESCE(count(*), 0) succCnt, COALESCE(sum(TXN_AMT), 0)
		totSuccAmt from
		eups.EUPS_TRANS_JOURNAL d where d.TXN_STS='S' AND
		d.MFM_TXN_STS='S'
		and d.THD_TXN_STS!='U' and d.THD_TXN_STS!='F' and
		d.THD_TXN_STS!='T'
		and d.TXN_DTE &gt;=#{beginDte} and
		d.TXN_DTE
		&lt;=#{endDte} and
		d.COM_NO=#{comNo} and d.TXN_TYP!='C') b
	</select>

	<!-- 燃气报表打印—失败 findGasFalJnlInfo -->
	<select id="findGasFalJnlInfo" resultType="java.util.Map"
		parameterType="java.util.Map">
		select * from
		(select * from eups.EUPS_TRANS_JOURNAL
		where TXN_STS='F' AND (MFM_TXN_STS='F'
		or (MFM_TXN_STS='S' and
		THD_TXN_STS='F')) and TXN_DTE &gt;=#{beginDte} and
		TXN_DTE
		&lt;=#{endDte} and
		com_NO=#{comNo} and TXN_TYP!='C') a,
		(select
		COALESCE(count(*), 0) failCnt, COALESCE(sum(TXN_AMT), 0) totFailAmt
		from
		eups.EUPS_TRANS_JOURNAL
		where TXN_STS='F' AND (MFM_TXN_STS='F' or
		(MFM_TXN_STS='S' and
		THD_TXN_STS='F')) and TXN_DTE &gt;=#{beginDte} and
		TXN_DTE &lt;=#{endDte} and
		com_NO=#{comNo} and TXN_TYP!='C') b
	</select>

	<!-- 燃气报表打印—汇总 findGasAllJnlInfo -->
	<select id="findGasAllJnlInfo" resultType="java.util.Map"
		parameterType="java.util.Map">
		select * FROM
		<!-- (select * FROM eups.EUPS_TRANS_JOURNAL where TXN_DTE &gt;=#{beginDte} 
			and TXN_DTE &lt;=#{endDte} and COM_NO=#{comNo} ) a, -->
		(select
		COALESCE(count(*), 0) totCnt,
		COALESCE(sum(TXN_AMT), 0) totAmt
		from
		eups.EUPS_TRANS_JOURNAL
		where
		TXN_DTE &gt;=#{beginDte} and TXN_DTE
		&lt;=#{endDte} and
		COM_NO=#{comNo}) b,
		(select COALESCE(count(*), 0)
		succCnt,
		COALESCE(sum(TXN_AMT), 0) totSuccAmt from
		eups.EUPS_TRANS_JOURNAL d
		where d.TXN_STS='S' AND d.MFM_TXN_STS='S'
		and d.THD_TXN_STS!='U' and
		d.THD_TXN_STS!='F' and d.THD_TXN_STS!='T'
		and d.TXN_DTE
		&gt;=#{beginDte} and d.TXN_DTE &lt;=#{endDte} and
		d.COM_NO=#{comNo} and
		d.TXN_TYP!='C') c,
		(select COALESCE(count(*), 0)
		failCnt,
		COALESCE(sum(TXN_AMT), 0) totFailAmt from
		eups.EUPS_TRANS_JOURNAL where
		TXN_STS='F' AND (MFM_TXN_STS='F' or
		(MFM_TXN_STS='S' and
		THD_TXN_STS='F')) and
		TXN_DTE &gt;=#{beginDte}
		and TXN_DTE
		&lt;=#{endDte} and
		COM_NO=#{comNo} and TXN_TYP!='C') e,
		(select
		COALESCE(count(*), 0) doubtCnt, COALESCE(sum(TXN_AMT), 0)
		totDoubtAmt
		from
		eups.EUPS_TRANS_JOURNAL c where c.MFM_TXN_STS='S' and
		c.THD_TXN_STS!='S' and c.THD_TXN_STS!='F' and c.MFM_TXN_STS!='C' and
		c.TXN_TYP!='C' and c.TXN_DTE &gt;=#{beginDte} and c.TXN_DTE
		&lt;=#{endDte} and
		c.COM_NO=#{comNo}) d,
		(select COALESCE(count(*), 0)
		otherCnt, COALESCE(sum(TXN_AMT), 0) totOtherAmt from
		eups.EUPS_TRANS_JOURNAL where sqn not in(select a.sqn from (select
		distinct a.sqn as sqn from eups.EUPS_TRANS_JOURNAL a where
		a.TXN_STS='F' AND (a.MFM_TXN_STS='F' or (a.MFM_TXN_STS='S' and
		a.THD_TXN_STS='F')) and a.TXN_DTE &gt;=#{beginDte} and a.TXN_DTE
		&lt;=#{endDte} and
		a.COM_NO=#{comNo} and a.TXN_TYP!='C') a) and
		sqn not
		in(select b.sqn from(select distinct b.sqn as sqn from
		eups.EUPS_TRANS_JOURNAL b where b.MFM_TXN_STS='S' and
		b.THD_TXN_STS!='S' and b.THD_TXN_STS!='F' and b.MFM_TXN_STS!='C' and
		b.TXN_TYP!='C' and b.TXN_DTE &gt;=#{beginDte} and b.TXN_DTE
		&lt;=#{endDte} and
		b.COM_NO=#{comNo})b) and sqn not in(select
		c.sqn
		from(select c.sqn as sqn from eups.EUPS_TRANS_JOURNAL c where
		c.TXN_STS='S' AND c.MFM_TXN_STS='S' and c.THD_TXN_STS!='U' and
		c.THD_TXN_STS!='F' and c.THD_TXN_STS!='T' and
		c.TXN_DTE
		&gt;=#{beginDte} and c.TXN_DTE &lt;=#{endDte} and
		c.COM_NO=#{comNo}
		and
		c.TXN_TYP!='C')c) and
		TXN_DTE &gt;=#{beginDte} and TXN_DTE
		&lt;=#{endDte} and
		COM_NO=#{comNo}) y
	</select>


	<select id="findRptJnlInfo" resultType="java.util.Map"
		parameterType="com.bocom.bbip.gdeupsb.entity.GdEupsTransJournal">
		select * FROM
		(select count(*) totCnt, COALESCE(sum(TXN_AMT), 0) totAmt
		from
		eups.EUPS_TRANS_JOURNAL
		<trim prefix="WHERE" prefixOverrides="AND">
			<if test="comNo!=null">
				AND COM_NO=#{comNo,jdbcType=CHAR}
			</if>
			<if test="eupsBusTyp!=null">
				AND EUPS_BUS_TYP=#{eupsBusTyp,jdbcType=CHAR} AND TXN_TYP !='C' AND MFM_TXN_STS !='C'
			</if>
			<if test="txnDte!=null">
				AND TXN_DTE=#{txnDte,jdbcType=DATE}
			</if>
		</trim>
		) b,
		(select count(*) succCnt, COALESCE(sum(TXN_AMT), 0) totSuccAmt
		from
		eups.EUPS_TRANS_JOURNAL d
		<trim prefix="WHERE" prefixOverrides="AND">
			<if test="comNo!=null">
				AND d.COM_NO=#{comNo,jdbcType=CHAR}
			</if>
			<if test="eupsBusTyp!=null">
				AND d.EUPS_BUS_TYP=#{eupsBusTyp,jdbcType=CHAR} AND D.TXN_TYP !='C' AND D.MFM_TXN_STS !='C'
			</if>
			<if test="txnDte!=null">
				AND d.TXN_DTE=#{txnDte,jdbcType=DATE} and d.TXN_STS='S'
				AND d.MFM_TXN_STS='S' 
			</if>
		</trim>
		) c,
		(select count(*) failCnt, COALESCE(sum(TXN_AMT), 0) totFailAmt
		from
		eups.EUPS_TRANS_JOURNAL
		<trim prefix="WHERE" prefixOverrides="AND">
			<if test="comNo!=null">
				AND COM_NO=#{comNo,jdbcType=CHAR}
			</if>
			<if test="eupsBusTyp!=null">
				AND EUPS_BUS_TYP=#{eupsBusTyp,jdbcType=CHAR} AND TXN_TYP !='C' AND MFM_TXN_STS !='C'
			</if>
			<if test="txnDte!=null">
				AND TXN_DTE=#{txnDte,jdbcType=DATE} and TXN_STS='F' AND
				(MFM_TXN_STS='F' or (MFM_TXN_STS='S' and THD_TXN_STS='F')) and
				TXN_TYP!='C'
			</if>
		</trim>
		) e,
		(select count(*) doubtCnt, COALESCE(sum(TXN_AMT), 0) totDoubtAmt
		from
		eups.EUPS_TRANS_JOURNAL c
		<trim prefix="WHERE" prefixOverrides="AND">
			<if test="comNo!=null">
				AND c.COM_NO=#{comNo,jdbcType=CHAR}
			</if>
			<if test="eupsBusTyp!=null">
				AND c.EUPS_BUS_TYP=#{eupsBusTyp,jdbcType=CHAR} AND C.TXN_TYP !='C' AND C.MFM_TXN_STS !='C'
			</if>
			<if test="txnDte!=null">
				AND c.TXN_DTE=#{txnDte,jdbcType=DATE} and C.TXN_STS !='S'
				c.MFM_TXN_STS='S' and c.THD_TXN_STS!='S' and c.THD_TXN_STS!='F' and
				c.MFM_TXN_STS!='C' and c.TXN_TYP!='C'
			</if>
		</trim>
		) d,
		(select count(*) othertCnt, COALESCE(sum(TXN_AMT), 0) totOtherAmt
		from
		eups.EUPS_TRANS_JOURNAL c
		<trim prefix="WHERE" prefixOverrides="AND">
			<if test="comNo!=null">
				AND c.COM_NO=#{comNo,jdbcType=CHAR}
			</if>
			<if test="eupsBusTyp!=null">
				AND c.EUPS_BUS_TYP=#{eupsBusTyp,jdbcType=CHAR}
			</if>
			<if test="txnDte!=null">
				AND c.TXN_DTE=#{txnDte,jdbcType=DATE} and
				sqn not in(select a.sqn
				from (select distinct a.sqn as sqn from
				eups.EUPS_TRANS_JOURNAL a
				<trim prefix="WHERE" prefixOverrides="AND">
					<if test="comNo!=null">
						AND a.COM_NO=#{comNo,jdbcType=CHAR}
					</if>
					<if test="eupsBusTyp!=null">
						AND a.EUPS_BUS_TYP=#{eupsBusTyp,jdbcType=CHAR} AND A.TXN_TYP !='C' AND A.MFM_TXN_STS !='C'
					</if>
					<if test="txnDte!=null">
						AND a.TXN_DTE=#{txnDte,jdbcType=DATE} and a.TXN_STS='F'
						AND
						(a.MFM_TXN_STS='F' or (a.MFM_TXN_STS='S' and
						a.THD_TXN_STS='F'))
						and a.TXN_TYP!='C' )
					</if>
				</trim>
				a)
				and sqn not in(select b.sqn from(select distinct b.sqn as sqn from
				eups.EUPS_TRANS_JOURNAL b
				<trim prefix="WHERE" prefixOverrides="AND">
					<if test="comNo!=null">
						AND b.COM_NO=#{comNo,jdbcType=CHAR}
					</if>
					<if test="eupsBusTyp!=null">
						AND b.EUPS_BUS_TYP=#{eupsBusTyp,jdbcType=CHAR}
					</if>
					<if test="txnDte!=null">
						AND b.TXN_DTE=#{txnDte,jdbcType=DATE} and
						b.MFM_TXN_STS='S'  AND B.TXN_STS='S' AND
						b.MFM_TXN_STS!='C'
						and b.TXN_TYP!='C' )
					</if>
				</trim>
				b)
				and sqn not in(select c.sqn from(select c.sqn as sqn from
				eups.EUPS_TRANS_JOURNAL c
				<trim prefix="WHERE" prefixOverrides="AND">
					<if test="comNo!=null">
						AND c.COM_NO=#{comNo,jdbcType=CHAR}
					</if>
					<if test="eupsBusTyp!=null">
						AND c.EUPS_BUS_TYP=#{eupsBusTyp,jdbcType=CHAR}
					</if>
					<if test="txnDte!=null">
						AND c.TXN_DTE=#{txnDte,jdbcType=DATE} and c.TXN_STS='S'
						AND
						c.MFM_TXN_STS='S' and c.THD_TXN_STS!='U' and c.THD_TXN_STS!='F'
						and c.THD_TXN_STS!='T' and c.TXN_TYP!='C')
					</if>
				</trim>
				c)
			</if>
		</trim>
		) y
	</select>


	<select id="findGasCheckRec" resultType="java.util.Map"
		parameterType="java.util.Map">
		SELECT SQN, strip(bak_fld2, b) THDSTS, strip(RSV_FLD5,
		b) BKC, strip(THD_SQN, b) THDSQN,
		strip(THD_CUS_NO, b) THDCUSNOC,
		strip(RSV_FLD6, b) PAYYEA, TXN_AMT TXNAMT, TXN_DTE TXNDTE
		FROM
		EUPS.EUPS_TRANS_JOURNAL WHERE TXN_TYP!='C' AND
		EUPS_BUS_TYP='PGAS00'
		AND TXN_DTE=#{txnDte, jdbcType=DATE} ORDER BY SQN
	</select>

	<select id="findElec00AllTxnList" resultType="java.util.Map"
		parameterType="com.bocom.bbip.gdeupsb.entity.GdEupsTransJournal">


		<!-- select * FROM
		(select count(*) totCnt,COALESCE(sum(TXN_AMT), 0) totAmt from
		eups.EUPS_TRANS_JOURNAL where TXN_DTE=#{txnDte, jdbcType=DATE} and
		eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and
		subStr(BAK_FLD2,1,2)='03')a,
		(select count(*)
		QYtotCnt,COALESCE(sum(TXN_AMT), 0) QYtotAmt from
		eups.EUPS_TRANS_JOURNAL where TXN_DTE=#{txnDte, jdbcType=DATE} and
		eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and BAK_FLD2='0318') b,
		(select count(*) QYsuccCnt, COALESCE(sum(TXN_AMT), 0) QYtotSuccAmt
		from eups.EUPS_TRANS_JOURNAL d where d.TXN_STS='S' AND
		d.MFM_TXN_STS='S' and d.THD_TXN_STS!='U' and d.THD_TXN_STS!='F' and
		d.THD_TXN_STS!='T' and d.TXN_DTE=#{txnDte, jdbcType=DATE} and
		d.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and d.TXN_TYP!='C' and
		BAK_FLD2='0318') c,
		(select count(*) QYfailCnt, COALESCE(sum(TXN_AMT),
		0) QYtotFailAmt from eups.EUPS_TRANS_JOURNAL where TXN_STS='F' AND
		(MFM_TXN_STS='F' or (MFM_TXN_STS='S' and THD_TXN_STS='F')) and
		TXN_DTE=#{txnDte, jdbcType=DATE} and
		eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and TXN_TYP!='C' and
		BAK_FLD2='0318') e,
		(select count(*) QYdoubtCnt, COALESCE(sum(TXN_AMT),
		0) QYtotDoubtAmt from eups.EUPS_TRANS_JOURNAL c where
		c.MFM_TXN_STS='S' and c.THD_TXN_STS!='S' and c.THD_TXN_STS!='F' and
		c.MFM_TXN_STS!='C' and c.TXN_TYP!='C' and c.TXN_DTE=#{txnDte,
		jdbcType=DATE} and c.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and
		BAK_FLD2='0318') d,
		(select count(*) QYothertCnt,
		COALESCE(sum(TXN_AMT), 0) QYtotOtherAmt from
		eups.EUPS_TRANS_JOURNAL
		where sqn not in(select a.sqn from (select
		distinct a.sqn as sqn from
		eups.EUPS_TRANS_JOURNAL a where
		a.TXN_STS='F' AND (a.MFM_TXN_STS='F' or
		(a.MFM_TXN_STS='S' and
		a.THD_TXN_STS='F')) and a.TXN_DTE=#{txnDte,
		jdbcType=DATE} and
		a.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and
		a.TXN_TYP!='C'and
		BAK_FLD2='0318') a) and sqn not in(select
		b.sqn
		from(select
		distinct b.sqn as sqn from eups.EUPS_TRANS_JOURNAL b
		where
		b.MFM_TXN_STS='S' and b.THD_TXN_STS!='S' and b.THD_TXN_STS!='F'
		and
		b.MFM_TXN_STS!='C' and b.TXN_TYP!='C' and b.TXN_DTE=#{txnDte,
		jdbcType=DATE} and b.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and
		BAK_FLD2='0318')b) and sqn not in(select c.sqn from(select
		c.sqn as sqn
		from eups.EUPS_TRANS_JOURNAL c where c.TXN_STS='S' AND
		c.MFM_TXN_STS='S' and c.THD_TXN_STS!='U' and c.THD_TXN_STS!='F' and
		c.THD_TXN_STS!='T' and c.TXN_DTE=#{txnDte, jdbcType=DATE} and
		c.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and c.TXN_TYP!='C' and
		BAK_FLD2='0318')c) and TXN_DTE=#{txnDte, jdbcType=DATE} and
		eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and
		BAK_FLD2='0318') y,
		(select count(*) ZStotCnt,
		COALESCE(sum(TXN_AMT), 0) ZStotAmt from
		eups.EUPS_TRANS_JOURNAL where
		TXN_DTE=#{txnDte, jdbcType=DATE} and
		eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and
		BAK_FLD2='0320') f,
		(select count(*) ZSsuccCnt,
		COALESCE(sum(TXN_AMT), 0) ZStotSuccAmt from
		eups.EUPS_TRANS_JOURNAL d
		where d.TXN_STS='S' AND d.MFM_TXN_STS='S'
		and
		d.THD_TXN_STS!='U' and
		d.THD_TXN_STS!='F' and d.THD_TXN_STS!='T'
		and
		d.TXN_DTE=#{txnDte,
		jdbcType=DATE} and
		d.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and
		d.TXN_TYP!='C' and
		BAK_FLD2='0320') g,
		(select count(*)
		ZSfailCnt, COALESCE(sum(TXN_AMT),
		0) ZStotFailAmt from
		eups.EUPS_TRANS_JOURNAL where TXN_STS='F' AND
		(MFM_TXN_STS='F' or
		(MFM_TXN_STS='S' and THD_TXN_STS='F')) and
		TXN_DTE=#{txnDte,
		jdbcType=DATE} and
		eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and
		TXN_TYP!='C' and
		BAK_FLD2='0320') h,
		(select count(*)
		ZSdoubtCnt, COALESCE(sum(TXN_AMT),
		0) ZStotDoubtAmt from
		eups.EUPS_TRANS_JOURNAL c where c.MFM_TXN_STS='S'
		and
		c.THD_TXN_STS!='S' and c.THD_TXN_STS!='F' and c.MFM_TXN_STS!='C'
		and
		c.TXN_TYP!='C' and c.TXN_DTE=#{txnDte, jdbcType=DATE} and
		c.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and
		BAK_FLD2='0320') i,
		(select count(*) ZSothertCnt,
		COALESCE(sum(TXN_AMT), 0) ZStotOtherAmt
		from
		eups.EUPS_TRANS_JOURNAL
		where sqn not in(select a.sqn from (select
		distinct a.sqn as sqn from
		eups.EUPS_TRANS_JOURNAL a where
		a.TXN_STS='F' AND (a.MFM_TXN_STS='F' or
		(a.MFM_TXN_STS='S' and
		a.THD_TXN_STS='F')) and a.TXN_DTE=#{txnDte,
		jdbcType=DATE} and
		a.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and
		a.TXN_TYP!='C'and
		BAK_FLD2='0320') a) and sqn not in(select
		b.sqn from(select
		distinct
		b.sqn as sqn from eups.EUPS_TRANS_JOURNAL b
		where
		b.MFM_TXN_STS='S' and
		b.THD_TXN_STS!='S' and b.THD_TXN_STS!='F'
		and
		b.MFM_TXN_STS!='C' and
		b.TXN_TYP!='C' and b.TXN_DTE=#{txnDte,
		jdbcType=DATE} and
		b.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and
		BAK_FLD2='0320')b) and
		sqn not in(select c.sqn from(select
		c.sqn as sqn from
		eups.EUPS_TRANS_JOURNAL c where c.TXN_STS='S' AND
		c.MFM_TXN_STS='S' and
		c.THD_TXN_STS!='U' and c.THD_TXN_STS!='F' and
		c.THD_TXN_STS!='T' and
		c.TXN_DTE=#{txnDte, jdbcType=DATE} and
		c.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and c.TXN_TYP!='C' and
		BAK_FLD2='0320')c) and TXN_DTE=#{txnDte, jdbcType=DATE} and
		eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and
		BAK_FLD2='0320') j,
		(select count(*) FStotCnt,
		COALESCE(sum(TXN_AMT), 0) FStotAmt from
		eups.EUPS_TRANS_JOURNAL where
		TXN_DTE=#{txnDte, jdbcType=DATE} and
		eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and
		BAK_FLD2='0306') k,
		(select count(*) FSsuccCnt,
		COALESCE(sum(TXN_AMT), 0) FStotSuccAmt from
		eups.EUPS_TRANS_JOURNAL d
		where d.TXN_STS='S' AND d.MFM_TXN_STS='S'
		and
		d.THD_TXN_STS!='U' and
		d.THD_TXN_STS!='F' and d.THD_TXN_STS!='T'
		and
		d.TXN_DTE=#{txnDte,
		jdbcType=DATE} and
		d.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and
		d.TXN_TYP!='C' and
		BAK_FLD2='0306') l,
		(select count(*)
		FSfailCnt, COALESCE(sum(TXN_AMT),
		0) FStotFailAmt from
		eups.EUPS_TRANS_JOURNAL where TXN_STS='F' AND
		(MFM_TXN_STS='F' or
		(MFM_TXN_STS='S' and THD_TXN_STS='F')) and
		TXN_DTE=#{txnDte,
		jdbcType=DATE} and
		eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and
		TXN_TYP!='C' and
		BAK_FLD2='0306') m,
		(select count(*)
		FSdoubtCnt, COALESCE(sum(TXN_AMT),
		0) FStotDoubtAmt from
		eups.EUPS_TRANS_JOURNAL c where c.MFM_TXN_STS='S'
		and
		c.THD_TXN_STS!='S' and c.THD_TXN_STS!='F' and c.MFM_TXN_STS!='C'
		and
		c.TXN_TYP!='C' and c.TXN_DTE=#{txnDte, jdbcType=DATE} and
		c.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and
		BAK_FLD2='0306') n,
		(select count(*) FSothertCnt,
		COALESCE(sum(TXN_AMT), 0) FStotOtherAmt
		from
		eups.EUPS_TRANS_JOURNAL
		where sqn not in(select a.sqn from (select
		distinct a.sqn as sqn from
		eups.EUPS_TRANS_JOURNAL a where
		a.TXN_STS='F' AND (a.MFM_TXN_STS='F' or
		(a.MFM_TXN_STS='S' and
		a.THD_TXN_STS='F')) and a.TXN_DTE=#{txnDte,
		jdbcType=DATE} and
		a.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and
		a.TXN_TYP!='C'and
		BAK_FLD2='0306') a) and sqn not in(select
		b.sqn from(select
		distinct
		b.sqn as sqn from eups.EUPS_TRANS_JOURNAL b
		where
		b.MFM_TXN_STS='S' and
		b.THD_TXN_STS!='S' and b.THD_TXN_STS!='F'
		and
		b.MFM_TXN_STS!='C' and
		b.TXN_TYP!='C' and b.TXN_DTE=#{txnDte,
		jdbcType=DATE} and
		b.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and
		BAK_FLD2='0306')b) and
		sqn not in(select c.sqn from(select
		c.sqn as sqn from
		eups.EUPS_TRANS_JOURNAL c where c.TXN_STS='S' AND
		c.MFM_TXN_STS='S' and
		c.THD_TXN_STS!='U' and c.THD_TXN_STS!='F' and
		c.THD_TXN_STS!='T' and
		c.TXN_DTE=#{txnDte, jdbcType=DATE} and
		c.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and c.TXN_TYP!='C' and
		BAK_FLD2='0306')c) and TXN_DTE=#{txnDte, jdbcType=DATE} and
		eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and
		BAK_FLD2='0306') o -->
		
select * FROM
(select count(*) totCnt,COALESCE(sum(TXN_AMT), 0) totAmt from eups.EUPS_TRANS_JOURNAL where TXN_DTE=#{txnDte,jdbcType=DATE} and eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and subStr(BAK_FLD2,1,2)='03'AND TXN_TYP !='C' AND MFM_TXN_STS !='C') aa,

(select count(*) QYtotCnt ,COALESCE(sum(TXN_AMT), 0) QYtotAmt from eups.EUPS_TRANS_JOURNAL where TXN_DTE=#{txnDte,jdbcType=DATE} and eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} AND TXN_TYP !='C' AND MFM_TXN_STS !='C' and BAK_FLD2='0318') ab,
(select count(*) QYsuccCnt, COALESCE(sum(TXN_AMT), 0) QYtotSuccAmt from eups.EUPS_TRANS_JOURNAL a where  A.TXN_DTE=#{txnDte,jdbcType=DATE} and A.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} AND A.TXN_TYP !='C' AND A.MFM_TXN_STS !='C' and a.bak_fld2='0318'and ((A.CHL_TYP !='90' and A.TXN_STS='S' AND A.MFM_TXN_STS='S' AND A.THD_TXN_STS='S' ) or (A.CHL_TYP='90' and A.TXN_STS='S' AND A.MFM_TXN_STS='S' AND A.THD_TXN_STS !='F'  AND A.THD_TXN_STS !='T'  AND A.THD_TXN_STS !='R'))) ac,
(select count(*) QYfailCnt, COALESCE(sum(TXN_AMT), 0) QYtotFailAmt from eups.EUPS_TRANS_JOURNAL a where   A.TXN_DTE=#{txnDte,jdbcType=DATE} and A.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} AND A.TXN_TYP !='C' AND A.MFM_TXN_STS !='C' and ((A.CHL_TYP !='90' and A.TXN_STS='F' AND A.MFM_TXN_STS='F' ) or (A.CHL_TYP='90' and A.TXN_STS='F' AND A.MFM_TXN_STS='F' )) and a.BAK_FLD2='0318') ad,
(select count(*) QYdoubtCnt, COALESCE(sum(TXN_AMT), 0) QYtotDoubtAmt from eups.EUPS_TRANS_JOURNAL c where c.TXN_DTE=#{txnDte,jdbcType=DATE} and c.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} AND c.TXN_TYP !='C' AND c.MFM_TXN_STS !='C' and c.CHL_TYP !='90' and c.TXN_STS !='S' AND c.MFM_TXN_STS='S' AND c.THD_TXN_STS !='S' AND c.THD_TXN_STS !='F'  and BAK_FLD2='0318') ae,
(select count(*) QYothertCnt, COALESCE(sum(TXN_AMT), 0) QYtotOtherAmt from eups.EUPS_TRANS_JOURNAL where sqn not in(select distinct a.sqn as sqn from  eups.EUPS_TRANS_JOURNAL A where  A.TXN_DTE=#{txnDte,jdbcType=DATE} and A.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} AND A.TXN_TYP !='C' AND A.MFM_TXN_STS !='C' and ((A.CHL_TYP !='90' and A.TXN_STS='S' AND A.MFM_TXN_STS='S' AND A.THD_TXN_STS='S' ) or (A.CHL_TYP='90' and A.TXN_STS='S' AND A.MFM_TXN_STS='S' AND A.THD_TXN_STS !='F'  AND A.THD_TXN_STS !='T'  AND A.THD_TXN_STS !='R'))) and sqn not in(select distinct a.sqn as sqn from  eups.EUPS_TRANS_JOURNAL A where  A.TXN_DTE=#{txnDte,jdbcType=DATE} and A.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} AND A.TXN_TYP !='C' AND A.MFM_TXN_STS !='C' and ((A.CHL_TYP !='90' and A.TXN_STS='F' AND A.MFM_TXN_STS='F' ) or (A.CHL_TYP='90' and A.TXN_STS='F' AND A.MFM_TXN_STS='F' ))) and sqn not in(select distinct a.sqn as sqn from  eups.EUPS_TRANS_JOURNAL A where  A.TXN_DTE=#{txnDte,jdbcType=DATE} and A.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} AND A.TXN_TYP !='C' AND A.MFM_TXN_STS !='C' and A.CHL_TYP !='90' and A.TXN_STS !='S' AND A.MFM_TXN_STS='S' AND A.THD_TXN_STS !='S' AND A.THD_TXN_STS !='F' ) and TXN_DTE=#{txnDte,jdbcType=DATE} and eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} AND TXN_TYP !='C' AND MFM_TXN_STS !='C' and TXN_DTE=#{txnDte,jdbcType=DATE} and eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and BAK_FLD2='0318') af,

(select count(*) zstotCnt ,COALESCE(sum(TXN_AMT), 0) zstotAmt from eups.EUPS_TRANS_JOURNAL where TXN_DTE=#{txnDte,jdbcType=DATE} and eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} AND TXN_TYP !='C' AND MFM_TXN_STS !='C' and BAK_FLD2='0320') aG,
(select count(*) zssuccCnt, COALESCE(sum(TXN_AMT), 0) zstotSuccAmt from eups.EUPS_TRANS_JOURNAL a where  A.TXN_DTE=#{txnDte,jdbcType=DATE} and A.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} AND A.TXN_TYP !='C' AND A.MFM_TXN_STS !='C' and a.bak_fld2='0320'and ((A.CHL_TYP !='90' and A.TXN_STS='S' AND A.MFM_TXN_STS='S' AND A.THD_TXN_STS='S' ) or (A.CHL_TYP='90' and A.TXN_STS='S' AND A.MFM_TXN_STS='S' AND A.THD_TXN_STS !='F'  AND A.THD_TXN_STS !='T'  AND A.THD_TXN_STS !='R'))) aH,
(select count(*) zsfailCnt, COALESCE(sum(TXN_AMT), 0) zstotFailAmt from eups.EUPS_TRANS_JOURNAL a where   A.TXN_DTE=#{txnDte,jdbcType=DATE} and A.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} AND A.TXN_TYP !='C' AND A.MFM_TXN_STS !='C' and ((A.CHL_TYP !='90' and A.TXN_STS='F' AND A.MFM_TXN_STS='F' ) or (A.CHL_TYP='90' and A.TXN_STS='F' AND A.MFM_TXN_STS='F' )) and a.BAK_FLD2='0320') aI,
(select count(*) zsdoubtCnt, COALESCE(sum(TXN_AMT), 0) zstotDoubtAmt from eups.EUPS_TRANS_JOURNAL c where c.TXN_DTE=#{txnDte,jdbcType=DATE} and c.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} AND c.TXN_TYP !='C' AND c.MFM_TXN_STS !='C' and c.CHL_TYP !='90' and c.TXN_STS !='S' AND c.MFM_TXN_STS='S' AND c.THD_TXN_STS !='S' AND c.THD_TXN_STS !='F'  and BAK_FLD2='0320') aJ,
(select count(*) zsothertCnt, COALESCE(sum(TXN_AMT), 0) zstotOtherAmt from eups.EUPS_TRANS_JOURNAL where sqn not in(select distinct a.sqn as sqn from  eups.EUPS_TRANS_JOURNAL A where  A.TXN_DTE=#{txnDte,jdbcType=DATE} and A.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} AND A.TXN_TYP !='C' AND A.MFM_TXN_STS !='C' and ((A.CHL_TYP !='90' and A.TXN_STS='S' AND A.MFM_TXN_STS='S' AND A.THD_TXN_STS='S' ) or (A.CHL_TYP='90' and A.TXN_STS='S' AND A.MFM_TXN_STS='S' AND A.THD_TXN_STS !='F'  AND A.THD_TXN_STS !='T'  AND A.THD_TXN_STS !='R'))) and sqn not in(select distinct a.sqn as sqn from  eups.EUPS_TRANS_JOURNAL A where  A.TXN_DTE=#{txnDte,jdbcType=DATE} and A.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} AND A.TXN_TYP !='C' AND A.MFM_TXN_STS !='C' and ((A.CHL_TYP !='90' and A.TXN_STS='F' AND A.MFM_TXN_STS='F' ) or (A.CHL_TYP='90' and A.TXN_STS='F' AND A.MFM_TXN_STS='F' ))) and sqn not in(select distinct a.sqn as sqn from  eups.EUPS_TRANS_JOURNAL A where  A.TXN_DTE=#{txnDte,jdbcType=DATE} and A.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} AND A.TXN_TYP !='C' AND A.MFM_TXN_STS !='C' and A.CHL_TYP !='90' and A.TXN_STS !='S' AND A.MFM_TXN_STS='S' AND A.THD_TXN_STS !='S' AND A.THD_TXN_STS !='F' ) and TXN_DTE=#{txnDte,jdbcType=DATE} and eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} AND TXN_TYP !='C' AND MFM_TXN_STS !='C' and TXN_DTE=#{txnDte,jdbcType=DATE} and eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and BAK_FLD2='0320') aK,

(select count(*) FStotCnt ,COALESCE(sum(TXN_AMT), 0) FStotAmt from eups.EUPS_TRANS_JOURNAL where TXN_DTE=#{txnDte,jdbcType=DATE} and eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} AND TXN_TYP !='C' AND MFM_TXN_STS !='C' and BAK_FLD2='0306') aL,
(select count(*) FSsuccCnt, COALESCE(sum(TXN_AMT), 0) FStotSuccAmt from eups.EUPS_TRANS_JOURNAL a where  A.TXN_DTE=#{txnDte,jdbcType=DATE} and A.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} AND A.TXN_TYP !='C' AND A.MFM_TXN_STS !='C' and a.bak_fld2='0306'and ((A.CHL_TYP !='90' and A.TXN_STS='S' AND A.MFM_TXN_STS='S' AND A.THD_TXN_STS='S' ) or (A.CHL_TYP='90' and A.TXN_STS='S' AND A.MFM_TXN_STS='S' AND A.THD_TXN_STS !='F'  AND A.THD_TXN_STS !='T'  AND A.THD_TXN_STS !='R'))) aM,
(select count(*) FSfailCnt, COALESCE(sum(TXN_AMT), 0) FStotFailAmt from eups.EUPS_TRANS_JOURNAL a where   A.TXN_DTE=#{txnDte,jdbcType=DATE} and A.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} AND A.TXN_TYP !='C' AND A.MFM_TXN_STS !='C' and ((A.CHL_TYP !='90' and A.TXN_STS='F' AND A.MFM_TXN_STS='F' ) or (A.CHL_TYP='90' and A.TXN_STS='F' AND A.MFM_TXN_STS='F' )) and a.BAK_FLD2='0306') aN,
(select count(*) FSdoubtCnt, COALESCE(sum(TXN_AMT), 0) FStotDoubtAmt from eups.EUPS_TRANS_JOURNAL c where c.TXN_DTE=#{txnDte,jdbcType=DATE} and c.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} AND c.TXN_TYP !='C' AND c.MFM_TXN_STS !='C' and c.CHL_TYP !='90' and c.TXN_STS !='S' AND c.MFM_TXN_STS='S' AND c.THD_TXN_STS !='S' AND c.THD_TXN_STS !='F'  and BAK_FLD2='0306') aO,
(select count(*) FSothertCnt, COALESCE(sum(TXN_AMT), 0) FStotOtherAmt from eups.EUPS_TRANS_JOURNAL where sqn not in(select distinct a.sqn as sqn from  eups.EUPS_TRANS_JOURNAL A where  A.TXN_DTE=#{txnDte,jdbcType=DATE} and A.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} AND A.TXN_TYP !='C' AND A.MFM_TXN_STS !='C' and ((A.CHL_TYP !='90' and A.TXN_STS='S' AND A.MFM_TXN_STS='S' AND A.THD_TXN_STS='S' ) or (A.CHL_TYP='90' and A.TXN_STS='S' AND A.MFM_TXN_STS='S' AND A.THD_TXN_STS !='F'  AND A.THD_TXN_STS !='T'  AND A.THD_TXN_STS !='R'))) and sqn not in(select distinct a.sqn as sqn from  eups.EUPS_TRANS_JOURNAL A where  A.TXN_DTE=#{txnDte,jdbcType=DATE} and A.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} AND A.TXN_TYP !='C' AND A.MFM_TXN_STS !='C' and ((A.CHL_TYP !='90' and A.TXN_STS='F' AND A.MFM_TXN_STS='F' ) or (A.CHL_TYP='90' and A.TXN_STS='F' AND A.MFM_TXN_STS='F' ))) and sqn not in(select distinct a.sqn as sqn from  eups.EUPS_TRANS_JOURNAL A where  A.TXN_DTE=#{txnDte,jdbcType=DATE} and A.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} AND A.TXN_TYP !='C' AND A.MFM_TXN_STS !='C' and A.CHL_TYP !='90' and A.TXN_STS !='S' AND A.MFM_TXN_STS='S' AND A.THD_TXN_STS !='S' AND A.THD_TXN_STS !='F' ) and TXN_DTE=#{txnDte,jdbcType=DATE} and eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} AND TXN_TYP !='C' AND MFM_TXN_STS !='C' and TXN_DTE=#{txnDte,jdbcType=DATE} and eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and BAK_FLD2='0306') aP
		


	</select>



	<select id="findElec00SusList" resultType="java.util.Map"
		parameterType="com.bocom.bbip.gdeupsb.entity.GdEupsTransJournal">
SELECT * FROM(
select * from  eups.EUPS_TRANS_JOURNAL A
 where  A.TXN_DTE=#{txnDte,jdbcType=DATE} and A.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} AND A.TXN_TYP !='C' AND A.MFM_TXN_STS !='C'
and 
((
A.CHL_TYP !='90' and A.TXN_STS='S' AND A.MFM_TXN_STS='S' AND A.THD_TXN_STS='S' 
) 
or 
(
A.CHL_TYP='90' and A.TXN_STS='S' AND A.MFM_TXN_STS='S' AND A.THD_TXN_STS !='F'  AND A.THD_TXN_STS !='T'  AND A.THD_TXN_STS !='R'
)) ) C,
(select  COALESCE(count(*), 0) succCnt, COALESCE(sum(TXN_AMT), 0)
		totSuccAmt  from  eups.EUPS_TRANS_JOURNAL B
 where  B.TXN_DTE=#{txnDte,jdbcType=DATE} and B.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} AND B.TXN_TYP !='C' AND B.MFM_TXN_STS !='C'
and 
((
B.CHL_TYP !='90' and B.TXN_STS='S' AND B.MFM_TXN_STS='S' AND B.THD_TXN_STS='S'
) 
or 
(
B.CHL_TYP='90' and B.TXN_STS='S' AND B.MFM_TXN_STS='S' AND B.THD_TXN_STS !='F'  AND B.THD_TXN_STS !='T'  AND B.THD_TXN_STS !='R'
)) ) D  ORDER BY bak_fld2
	</select>
	
	
	<select id="findEfekRptJnlInfo" resultType="java.util.Map"
		parameterType="com.bocom.bbip.gdeupsb.entity.GdEupsTransJournal">
	
select * FROM
(select count(*) TOTCNT,COALESCE(sum(TXN_AMT), 0) TOTAMT from eups.EUPS_TRANS_JOURNAL where TXN_DTE =#{txnDte,jdbcType=DATE} and eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} and subStr(BAK_FLD2,1,2)='03'AND TXN_TYP !='C' AND MFM_TXN_STS !='C') aa,
(select count(*) SUCCCNT, COALESCE(sum(TXN_AMT), 0) TOTSUCCAMT from eups.EUPS_TRANS_JOURNAL a where  A.TXN_DTE =#{txnDte,jdbcType=DATE} and A.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} AND A.TXN_TYP !='C' AND A.MFM_TXN_STS !='C' and ((A.CHL_TYP !='90' and A.TXN_STS='S' AND A.MFM_TXN_STS='S' AND A.THD_TXN_STS='S' ) or (A.CHL_TYP='90' and A.TXN_STS='S' AND A.MFM_TXN_STS='S' AND A.THD_TXN_STS !='F'  AND A.THD_TXN_STS !='T'  AND A.THD_TXN_STS !='R'))) ac,
(select count(*) FAILCNT, COALESCE(sum(TXN_AMT), 0) TOTFAILAMT from eups.EUPS_TRANS_JOURNAL a where   A.TXN_DTE =#{txnDte,jdbcType=DATE} and A.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} AND A.TXN_TYP !='C' AND A.MFM_TXN_STS !='C' and ((A.CHL_TYP !='90' and A.TXN_STS='F' AND A.MFM_TXN_STS='F' ) or (A.CHL_TYP='90' and A.TXN_STS='F' AND A.MFM_TXN_STS='F'  ))) ad,
(select count(*) DOUBTCNT, COALESCE(sum(TXN_AMT), 0) TOTDOUBTAMT from eups.EUPS_TRANS_JOURNAL c where c.TXN_DTE =#{txnDte,jdbcType=DATE} and c.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} AND c.TXN_TYP !='C' AND c.MFM_TXN_STS !='C' and c.CHL_TYP !='90' and c.TXN_STS !='S' AND c.MFM_TXN_STS='S' AND c.THD_TXN_STS !='S' AND c.THD_TXN_STS !='F' ) ae,
(select count(*) OTHERCNT, COALESCE(sum(TXN_AMT), 0) TOTOTHERAMT from eups.EUPS_TRANS_JOURNAL where sqn not in(select distinct a.sqn as sqn from  eups.EUPS_TRANS_JOURNAL A where  A.TXN_DTE =#{txnDte,jdbcType=DATE} and A.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} AND A.TXN_TYP !='C' AND A.MFM_TXN_STS !='C' and ((A.CHL_TYP !='90' and A.TXN_STS='S' AND A.MFM_TXN_STS='S' AND A.THD_TXN_STS='S' ) or (A.CHL_TYP='90' and A.TXN_STS='S' AND A.MFM_TXN_STS='S' AND A.THD_TXN_STS !='F'  AND A.THD_TXN_STS !='T'  AND A.THD_TXN_STS !='R'))) and sqn not in(select distinct a.sqn as sqn from  eups.EUPS_TRANS_JOURNAL A where  A.TXN_DTE =#{txnDte,jdbcType=DATE} and A.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} AND A.TXN_TYP !='C' AND A.MFM_TXN_STS !='C' and ((A.CHL_TYP !='90' and A.TXN_STS='F' AND A.MFM_TXN_STS='F' ) or (A.CHL_TYP='90' and A.TXN_STS='F' AND A.MFM_TXN_STS='F'  ))) and sqn not in(select distinct a.sqn as sqn from  eups.EUPS_TRANS_JOURNAL A where  A.TXN_DTE =#{txnDte,jdbcType=DATE} and A.eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} AND A.TXN_TYP !='C' AND A.MFM_TXN_STS !='C' and A.CHL_TYP !='90' and A.TXN_STS !='S' AND A.MFM_TXN_STS='S' AND A.THD_TXN_STS !='S' AND A.THD_TXN_STS !='F' ) and TXN_DTE =#{txnDte,jdbcType=DATE} and eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR} AND TXN_TYP !='C' AND MFM_TXN_STS !='C' and TXN_DTE =#{txnDte,jdbcType=DATE} and eups_bus_typ=#{eupsBusTyp,jdbcType=CHAR}) af

</select>

</mapper>