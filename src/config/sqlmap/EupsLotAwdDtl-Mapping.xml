<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.bocom.bbip.gdeupsb.entity.EupsLotAwdDtl" >
  <resultMap id="basicResultMap" type="com.bocom.bbip.gdeupsb.entity.EupsLotAwdDtl" >
    <result column="BRNO" property="brno" jdbcType="CHAR" />
    <result column="LOGNO" property="logno" jdbcType="CHAR" />
    <result column="TXNCOD" property="txncod" jdbcType="CHAR" />
    <result column="GAMEID" property="gameid" jdbcType="CHAR" />
    <result column="DRAWID" property="drawid" jdbcType="CHAR" />
    <result column="KENOID" property="kenoid" jdbcType="CHAR" />
    <result column="LOTNAM" property="lotnam" jdbcType="CHAR" />
    <result column="TXNLOG" property="txnlog" jdbcType="CHAR" />
    <result column="TLOGNO" property="tlogno" jdbcType="CHAR" />
    <result column="CUSNAM" property="cusnam" jdbcType="CHAR" />
    <result column="CRDNO" property="crdno" jdbcType="CHAR" />
    <result column="AWDAMT" property="awdamt" jdbcType="CHAR" />
    <result column="HTXNCD" property="htxncd" jdbcType="CHAR" />
    <result column="HLOGNO" property="hlogno" jdbcType="CHAR" />
    <result column="HRSPCD" property="hrspcd" jdbcType="CHAR" />
    <result column="HTXNST" property="htxnst" jdbcType="CHAR" />
    <result column="AWDDAT" property="awddat" jdbcType="CHAR" />
    <result column="AWDTIM" property="awdtim" jdbcType="CHAR" />
    <result column="AWDRTN" property="awdrtn" jdbcType="CHAR" />
    <result column="TCKNO" property="tckno" jdbcType="CHAR" />
  </resultMap>
  <sql id="baseColumnList" >
    BRNO, LOGNO, TXNCOD, GAMEID, DRAWID, KENOID, LOTNAM, TXNLOG, TLOGNO, CUSNAM, CRDNO, 
    AWDAMT, HTXNCD, HLOGNO, HRSPCD, HTXNST, AWDDAT, AWDTIM, AWDRTN, TCKNO
  </sql>
  <select id="find" resultMap="basicResultMap" >
    select
    <include refid="baseColumnList" />
    from ${EUPS_SCHEMA}.EUPS_LOT_AWD_DTL
    <trim prefix="WHERE" prefixOverrides="AND" >
      <if test="brno!=null" >
        AND  BRNO=#{brno,jdbcType=CHAR}
      </if>
      <if test="logno!=null" >
        AND  LOGNO=#{logno,jdbcType=CHAR}
      </if>
      <if test="txncod!=null" >
        AND  TXNCOD=#{txncod,jdbcType=CHAR}
      </if>
      <if test="gameid!=null" >
        AND  GAMEID=#{gameid,jdbcType=CHAR}
      </if>
      <if test="drawid!=null" >
        AND  DRAWID=#{drawid,jdbcType=CHAR}
      </if>
      <if test="kenoid!=null" >
        AND  KENOID=#{kenoid,jdbcType=CHAR}
      </if>
      <if test="lotnam!=null" >
        AND  LOTNAM=#{lotnam,jdbcType=CHAR}
      </if>
      <if test="txnlog!=null" >
        AND  TXNLOG=#{txnlog,jdbcType=CHAR}
      </if>
      <if test="tlogno!=null" >
        AND  TLOGNO=#{tlogno,jdbcType=CHAR}
      </if>
      <if test="cusnam!=null" >
        AND  CUSNAM=#{cusnam,jdbcType=CHAR}
      </if>
      <if test="crdno!=null" >
        AND  CRDNO=#{crdno,jdbcType=CHAR}
      </if>
      <if test="awdamt!=null" >
        AND  AWDAMT=#{awdamt,jdbcType=CHAR}
      </if>
      <if test="htxncd!=null" >
        AND  HTXNCD=#{htxncd,jdbcType=CHAR}
      </if>
      <if test="hlogno!=null" >
        AND  HLOGNO=#{hlogno,jdbcType=CHAR}
      </if>
      <if test="hrspcd!=null" >
        AND  HRSPCD=#{hrspcd,jdbcType=CHAR}
      </if>
      <if test="htxnst!=null" >
        AND  HTXNST=#{htxnst,jdbcType=CHAR}
      </if>
      <if test="awddat!=null" >
        AND  AWDDAT=#{awddat,jdbcType=CHAR}
      </if>
      <if test="awdtim!=null" >
        AND  AWDTIM=#{awdtim,jdbcType=CHAR}
      </if>
      <if test="awdrtn!=null" >
        AND  AWDRTN=#{awdrtn,jdbcType=CHAR}
      </if>
      <if test="tckno!=null" >
        AND  TCKNO=#{tckno,jdbcType=CHAR}
      </if>
    </trim>
  </select>
  <insert id="insert" parameterType="com.bocom.bbip.gdeupsb.entity.EupsLotAwdDtl" >
    insert into ${EUPS_SCHEMA}.EUPS_LOT_AWD_DTL
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="brno != null" >
        BRNO,
      </if>
      <if test="logno != null" >
        LOGNO,
      </if>
      <if test="txncod != null" >
        TXNCOD,
      </if>
      <if test="gameid != null" >
        GAMEID,
      </if>
      <if test="drawid != null" >
        DRAWID,
      </if>
      <if test="kenoid != null" >
        KENOID,
      </if>
      <if test="lotnam != null" >
        LOTNAM,
      </if>
      <if test="txnlog != null" >
        TXNLOG,
      </if>
      <if test="tlogno != null" >
        TLOGNO,
      </if>
      <if test="cusnam != null" >
        CUSNAM,
      </if>
      <if test="crdno != null" >
        CRDNO,
      </if>
      <if test="awdamt != null" >
        AWDAMT,
      </if>
      <if test="htxncd != null" >
        HTXNCD,
      </if>
      <if test="hlogno != null" >
        HLOGNO,
      </if>
      <if test="hrspcd != null" >
        HRSPCD,
      </if>
      <if test="htxnst != null" >
        HTXNST,
      </if>
      <if test="awddat != null" >
        AWDDAT,
      </if>
      <if test="awdtim != null" >
        AWDTIM,
      </if>
      <if test="awdrtn != null" >
        AWDRTN,
      </if>
      <if test="tckno != null" >
        TCKNO,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="brno != null" >
        #{brno,jdbcType=CHAR},
      </if>
      <if test="logno != null" >
        #{logno,jdbcType=CHAR},
      </if>
      <if test="txncod != null" >
        #{txncod,jdbcType=CHAR},
      </if>
      <if test="gameid != null" >
        #{gameid,jdbcType=CHAR},
      </if>
      <if test="drawid != null" >
        #{drawid,jdbcType=CHAR},
      </if>
      <if test="kenoid != null" >
        #{kenoid,jdbcType=CHAR},
      </if>
      <if test="lotnam != null" >
        #{lotnam,jdbcType=CHAR},
      </if>
      <if test="txnlog != null" >
        #{txnlog,jdbcType=CHAR},
      </if>
      <if test="tlogno != null" >
        #{tlogno,jdbcType=CHAR},
      </if>
      <if test="cusnam != null" >
        #{cusnam,jdbcType=CHAR},
      </if>
      <if test="crdno != null" >
        #{crdno,jdbcType=CHAR},
      </if>
      <if test="awdamt != null" >
        #{awdamt,jdbcType=CHAR},
      </if>
      <if test="htxncd != null" >
        #{htxncd,jdbcType=CHAR},
      </if>
      <if test="hlogno != null" >
        #{hlogno,jdbcType=CHAR},
      </if>
      <if test="hrspcd != null" >
        #{hrspcd,jdbcType=CHAR},
      </if>
      <if test="htxnst != null" >
        #{htxnst,jdbcType=CHAR},
      </if>
      <if test="awddat != null" >
        #{awddat,jdbcType=CHAR},
      </if>
      <if test="awdtim != null" >
        #{awdtim,jdbcType=CHAR},
      </if>
      <if test="awdrtn != null" >
        #{awdrtn,jdbcType=CHAR},
      </if>
      <if test="tckno != null" >
        #{tckno,jdbcType=CHAR},
      </if>
    </trim>
  </insert>
  <select id="findCount" resultType="java.lang.Integer" >
    select count(*) from ${EUPS_SCHEMA}.EUPS_LOT_AWD_DTL
    <trim prefix="WHERE" prefixOverrides="AND" >
      <if test="brno!=null" >
        AND  BRNO=#{brno,jdbcType=CHAR}
      </if>
      <if test="logno!=null" >
        AND  LOGNO=#{logno,jdbcType=CHAR}
      </if>
      <if test="txncod!=null" >
        AND  TXNCOD=#{txncod,jdbcType=CHAR}
      </if>
      <if test="gameid!=null" >
        AND  GAMEID=#{gameid,jdbcType=CHAR}
      </if>
      <if test="drawid!=null" >
        AND  DRAWID=#{drawid,jdbcType=CHAR}
      </if>
      <if test="kenoid!=null" >
        AND  KENOID=#{kenoid,jdbcType=CHAR}
      </if>
      <if test="lotnam!=null" >
        AND  LOTNAM=#{lotnam,jdbcType=CHAR}
      </if>
      <if test="txnlog!=null" >
        AND  TXNLOG=#{txnlog,jdbcType=CHAR}
      </if>
      <if test="tlogno!=null" >
        AND  TLOGNO=#{tlogno,jdbcType=CHAR}
      </if>
      <if test="cusnam!=null" >
        AND  CUSNAM=#{cusnam,jdbcType=CHAR}
      </if>
      <if test="crdno!=null" >
        AND  CRDNO=#{crdno,jdbcType=CHAR}
      </if>
      <if test="awdamt!=null" >
        AND  AWDAMT=#{awdamt,jdbcType=CHAR}
      </if>
      <if test="htxncd!=null" >
        AND  HTXNCD=#{htxncd,jdbcType=CHAR}
      </if>
      <if test="hlogno!=null" >
        AND  HLOGNO=#{hlogno,jdbcType=CHAR}
      </if>
      <if test="hrspcd!=null" >
        AND  HRSPCD=#{hrspcd,jdbcType=CHAR}
      </if>
      <if test="htxnst!=null" >
        AND  HTXNST=#{htxnst,jdbcType=CHAR}
      </if>
      <if test="awddat!=null" >
        AND  AWDDAT=#{awddat,jdbcType=CHAR}
      </if>
      <if test="awdtim!=null" >
        AND  AWDTIM=#{awdtim,jdbcType=CHAR}
      </if>
      <if test="awdrtn!=null" >
        AND  AWDRTN=#{awdrtn,jdbcType=CHAR}
      </if>
      <if test="tckno!=null" >
        AND  TCKNO=#{tckno,jdbcType=CHAR}
      </if>
    </trim>
  </select>
  <select id="findAll" resultMap="basicResultMap" >
    select 
    <include refid="baseColumnList" />
    from ${EUPS_SCHEMA}.EUPS_LOT_AWD_DTL
  </select>
  
  <insert id="insertAwdDtl" parameterType="com.bocom.bbip.gdeupsb.entity.EupsLotAwdDtl" >
    insert into ${EUPS_SCHEMA}.EUPS_LOT_AWD_DTL 
    	(BRNO,GAMEID,DRAWID,KENOID,LOTNAM,TXNLOG,TLOGNO,CUSNAM,CRDNO,AWDAMT) 
    select b.BrNo,a.GameId,a.DrawId,a.KenoId,b.LotNam,a.TxnLog,a.TLogNo,b.CusNam,b.CrdNo,a.TotPrz
          FROM  lotprzctl a,lottxnjnl b
          WHERE a.GameId=#{gameid,jdbcType=CHAR} and a.DrawId=#{drawid,jdbcType=CHAR} 
          		and a.KenoId=#{kenoid,jdbcType=CHAR} and a.GameId=b.GameId and a.DrawId=b.DrawId and a.KenoId=b.KenoId
                and a.BigBon='false' and a.TxnLog=b.TxnLog and a.TLogNo=b.TLogNo and b.TxnSts in ('S','T') and b.AwdRtn='0'
   </insert>
   <select id="sumAmt" resultType="map" parameterType="com.bocom.bbip.gdeupsb.entity.EupsLotAwdDtl">
    SELECT　COALESCE(SUM(CAST(AwdAmt AS BIGINT)),0) PrzAmt
          FROM lotawddtl
          WHERE  GameId=#{gameid,jdbcType=CHAR}  and DrawId=#{drawid,jdbcType=CHAR}
          	 and KenoId=#{kenoid,jdbcType=CHAR}
  </select>
   <select id="checkTxnLog" resultType="map">
    SELECT　COUNT(TXNLOG) dupnum
          FROM lotawddtl DESC
          GROUP BY  GameId,DrawId,KenoId FETCH FIRST 1 ROWS ONLY
  </select>
</mapper>